# SOCIAL-ACCOUNT - Social Media Profile Object Type

**Type ID:** `hypernet.social.account`
**Version:** 1.0
**Category:** 0.0.3 - Social Types
**Parent:** BaseObject
**Status:** Active - Core Social Type
**Created:** 2026-02-09
**Last Updated:** 2026-02-09

---

## Object Type Metadata

```yaml
type_name: "SocialAccount"
type_id: "hypernet.social.account"
version: "1.0"
parent_type: "BaseObject"
category: "0.0.3 - Social Types"
abstract: false
instantiable: true
```

---

## Purpose and Description

### What is a SocialAccount?

The SocialAccount object type represents a user's profile or account on a social media platform. This includes Instagram accounts, Twitter profiles, Facebook profiles, LinkedIn profiles, TikTok accounts, and more. SocialAccount tracks account metadata, growth metrics, and serves as the publishing identity for social posts.

### Revolutionary Design Philosophy

Hypernet preserves complete social media identity and history:
- **Identity Preservation** - Keep permanent record of social profiles even after platform deletion
- **Multi-Platform Tracking** - Manage multiple accounts across different platforms from one place
- **Growth Analytics** - Track follower count, engagement trends, and profile evolution over time
- **Account Archaeology** - Preserve username changes, bio updates, and profile photo history
- **Professional Portfolio** - Document social media presence for professional credibility
- **Platform Independence** - Own your social graph and metrics independent of platform access

### Core Functions

1. **Profile Archival** - Permanently store social media profile information
2. **Growth Tracking** - Monitor follower counts and engagement metrics over time
3. **Identity Management** - Track username changes and profile updates
4. **Post Attribution** - Link all posts to specific social accounts
5. **Analytics Foundation** - Provide account-level metrics for performance analysis
6. **Integration Management** - Manage connected accounts for data sync

### When to Use

- Connecting social media accounts to Hypernet
- Importing historical profile data from platforms
- Tracking multiple accounts on the same platform (personal, business, etc.)
- Preserving profile history before deleting platform account
- Building professional portfolio of social media presence
- Analyzing account growth and engagement trends

---

## Inherited Fields from BaseObject

```yaml
id: UUID
  - Globally unique account identifier
  - Generated on account connection

created_at: DateTime
  - Connection timestamp (when added to Hypernet)
  - Immutable
  - May differ from account_created_at (platform creation date)

updated_at: DateTime
  - Last modification timestamp
  - Auto-updated when profile synced or metadata changed

deleted_at: DateTime (nullable)
  - Soft delete timestamp
  - Null for active accounts
  - Accounts preserved indefinitely unless user deletes

user_id: UUID
  - Foreign key to User who owns this account
  - Required - all social accounts must have an owner
  - Immutable

metadata: JSONB
  - Extensible metadata storage
  - See Metadata Schema section below
  - Stores platform-specific data, history, analytics
```

---

## Required Fields

### Account Identity

```yaml
platform: String(50)
  type: String
  max_length: 50
  nullable: false
  indexed: true
  description: "Social media platform for this account"
  allowed_values:
    - "instagram"
    - "facebook"
    - "twitter"
    - "linkedin"
    - "tiktok"
    - "youtube"
    - "reddit"
    - "threads"
    - "mastodon"
    - "snapchat"
    - "pinterest"
    - "other"
  examples:
    - "instagram" (personal or business)
    - "linkedin" (professional profile)

platform_user_id: String(200)
  type: String
  max_length: 200
  nullable: false
  indexed: true
  unique: "Per platform"
  description: "Unique user ID from platform"
  examples:
    - Instagram: "1234567890"
    - Twitter: "987654321"
    - Facebook: "100001234567890"
  purpose: "Stable identifier (doesn't change with username)"
  constraints:
    - Composite unique with (platform, platform_user_id)

username: String(200)
  type: String
  max_length: 200
  nullable: false
  indexed: true
  description: "Current username/handle on platform"
  examples:
    - "johndoe"
    - "@johndoe" (Twitter format)
    - "john.doe" (Instagram format)
  mutable: true
  history: "Previous usernames stored in metadata.username_history"
  constraints:
    - Trimmed of whitespace
    - Case-sensitive (platform-dependent)

account_type: Enum
  type: String
  max_length: 20
  nullable: false
  indexed: true
  default: "personal"
  description: "Type of social media account"
  allowed_values:
    - "personal": Individual personal account
    - "business": Business/brand account
    - "creator": Content creator account
    - "professional": Professional/LinkedIn account
    - "public": Public figure/celebrity account
  platform_specific:
    - Instagram: personal, business, creator
    - Facebook: personal, page, group
    - Twitter: personal, professional
```

---

## Optional Fields

### Profile Information

```yaml
display_name: String(200)
  type: String
  max_length: 200
  nullable: true
  description: "Display name on platform"
  examples:
    - "John Doe"
    - "Acme Corporation"
    - "Jane | Travel Blogger"
  mutable: true
  platform_field:
    - Instagram: "full_name"
    - Twitter: "name"
    - LinkedIn: "name"

bio: Text
  type: Text
  nullable: true
  max_length: 5000
  description: "Account biography/description"
  examples:
    - "Travel photographer | Based in SF | @sponsor partner"
    - "CEO @company | Passionate about tech and innovation"
  mutable: true
  searchable: true
  platform_limits:
    - Instagram: 150 chars
    - Twitter: 160 chars
    - LinkedIn: 2000 chars

profile_picture_url: String(1000)
  type: String
  max_length: 1000
  nullable: true
  description: "URL to current profile picture on platform"
  mutable: true
  behavior: "May become invalid if user changes picture or deletes account"
  archival: "Download and store as Media object for preservation"

profile_picture_media_id: UUID
  type: UUID
  nullable: true
  description: "Foreign key to Media object (archived profile picture)"
  references: "Media.id"
  cascade: "ON DELETE SET NULL"
  purpose: "Permanent archive of profile picture"

website: String(500)
  type: String
  max_length: 500
  nullable: true
  description: "Website URL from profile"
  examples:
    - "https://example.com"
    - "https://linktr.ee/username"
  validation: "Must be valid URL if provided"
```

### Account Status

```yaml
is_verified: Boolean
  type: Boolean
  nullable: false
  default: false
  description: "Whether account has platform verification badge"
  platform_names:
    - Instagram: "blue checkmark"
    - Twitter: "verified badge"
    - LinkedIn: "verified profile"

is_private: Boolean
  type: Boolean
  nullable: false
  default: false
  description: "Whether account is private/protected"
  examples:
    - Instagram private account
    - Twitter protected tweets
  impact: "Affects data availability via API"

is_active: Boolean
  type: Boolean
  nullable: false
  default: true
  indexed: true
  description: "Whether account is currently active on platform"
  usage:
    true: Account exists and accessible
    false: Account deactivated, suspended, or deleted on platform

account_created_at: DateTime
  type: DateTime
  nullable: true
  timezone: true
  description: "When account was created on platform"
  sources: "Platform API (if available)"
  usage: "Calculate account age"
```

### Follower Metrics

```yaml
follower_count: Integer
  type: Integer
  nullable: false
  default: 0
  indexed: true
  description: "Current number of followers"
  platform_names:
    - Instagram: "followers"
    - Twitter: "followers"
    - LinkedIn: "connections" or "followers"
  mutable: true
  tracking: "Historical values stored in metadata.follower_history"
  snapshot_frequency: "Daily via sync"

following_count: Integer
  type: Integer
  nullable: false
  default: 0
  indexed: true
  description: "Current number of accounts following"
  platform_names:
    - Instagram: "following"
    - Twitter: "following"
  mutable: true

post_count: Integer
  type: Integer
  nullable: false
  default: 0
  indexed: true
  description: "Total number of posts on platform"
  platform_names:
    - Instagram: "media_count"
    - Twitter: "tweet_count"
  mutable: true
  denormalized: "Also counted from SocialPost objects"
```

### Engagement Metrics

```yaml
avg_likes: Integer
  type: Integer
  nullable: true
  description: "Average likes per post"
  computed: "From recent posts (last 30 days)"
  usage: "Account performance metric"

avg_comments: Integer
  type: Integer
  nullable: true
  description: "Average comments per post"
  computed: "From recent posts"

engagement_rate: Decimal(5,4)
  type: Decimal
  precision: 5
  scale: 4
  nullable: true
  description: "Average engagement rate (0.0 to 1.0)"
  formula: "(avg_likes + avg_comments) / follower_count"
  computed: true
  usage: "Influencer analytics, account performance"
```

### Platform-Specific

```yaml
category: String(100)
  type: String
  max_length: 100
  nullable: true
  indexed: true
  description: "Account category on platform"
  applicable: "Instagram business accounts, Facebook pages"
  examples:
    - "Photographer"
    - "Restaurant"
    - "Personal Blog"
    - "Technology Company"

location: String(500)
  type: String
  max_length: 500
  nullable: true
  description: "Location from profile"
  examples:
    - "San Francisco, CA"
    - "New York, NY"
    - "Remote"

email: String(255)
  type: String
  max_length: 255
  nullable: true
  description: "Public email from profile"
  applicable: "Instagram business accounts"
  validation: "Valid email format if provided"

phone: String(50)
  type: String
  max_length: 50
  nullable: true
  description: "Public phone number from profile"
  applicable: "Instagram business accounts"
```

### Integration Connection

```yaml
integration_id: UUID
  type: UUID
  nullable: true
  indexed: true
  description: "Foreign key to Integration managing this account"
  references: "Integration.id"
  cascade: "ON DELETE SET NULL"
  purpose: "Track which integration connected this account"

last_synced_at: DateTime
  type: DateTime
  nullable: true
  timezone: true
  description: "Last successful data sync timestamp"
  updated: "After successful integration sync"
  usage: "Determine data freshness"

sync_enabled: Boolean
  type: Boolean
  nullable: false
  default: true
  description: "Whether to continue syncing data from this account"
  behavior:
    true: Regular syncs import new posts and update metrics
    false: Account static, no further syncing
```

### External Links

```yaml
profile_url: String(1000)
  type: String
  max_length: 1000
  nullable: true
  indexed: true
  description: "Public URL to profile on platform"
  format: "https://platform.com/username"
  examples:
    - "https://www.instagram.com/johndoe/"
    - "https://twitter.com/johndoe"
    - "https://www.linkedin.com/in/johndoe/"
  derivation: "Constructed from platform and username"
  behavior: "May become invalid if username changes or account deleted"
```

---

## Metadata Schema

The `metadata` JSONB field stores historical data, analytics, and platform-specific details:

```json
{
  "platform_data": {
    "instagram": {
      "account_type": "BUSINESS",
      "category": "Photographer",
      "contact_email": "business@example.com",
      "contact_phone": "+1-555-0100",
      "contact_address": "123 Main St, SF, CA",
      "is_business_account": true,
      "is_professional_account": false
    },
    "twitter": {
      "screen_name": "johndoe",
      "description": "Full bio text...",
      "verified": false,
      "protected": false,
      "listed_count": 42,
      "favourites_count": 1234
    },
    "linkedin": {
      "headline": "CEO at Company",
      "industry": "Technology",
      "public_profile_url": "https://linkedin.com/in/johndoe",
      "num_connections": 500,
      "positions": [
        {
          "title": "CEO",
          "company": "Acme Corp",
          "start_date": "2020-01"
        }
      ]
    }
  },
  "username_history": [
    {
      "username": "john.doe",
      "changed_at": "2023-01-15T10:00:00Z"
    },
    {
      "username": "johndoe",
      "changed_at": "2024-06-01T14:30:00Z"
    }
  ],
  "follower_history": [
    {
      "date": "2024-01-01",
      "count": 850,
      "following": 420
    },
    {
      "date": "2024-02-01",
      "count": 912,
      "following": 435
    },
    {
      "date": "2024-03-01",
      "count": 1045,
      "following": 440
    }
  ],
  "growth_analytics": {
    "follower_growth_rate_30d": 0.085,
    "follower_growth_rate_90d": 0.23,
    "best_performing_post_type": "photo",
    "avg_posting_frequency_per_week": 4.2,
    "peak_engagement_hours": [18, 19, 20],
    "top_hashtags": ["photography", "travel", "sunset"]
  },
  "profile_picture_history": [
    {
      "media_id": "media-uuid-1",
      "changed_at": "2023-05-10T12:00:00Z"
    },
    {
      "media_id": "media-uuid-2",
      "changed_at": "2024-01-20T15:30:00Z"
    }
  ],
  "bio_history": [
    {
      "bio": "Travel photographer based in SF",
      "changed_at": "2023-03-01T10:00:00Z"
    },
    {
      "bio": "Travel photographer | Based in SF | @sponsor partner",
      "changed_at": "2024-08-15T09:00:00Z"
    }
  ],
  "audience_insights": {
    "top_countries": ["US", "UK", "CA"],
    "age_ranges": {
      "18-24": 0.15,
      "25-34": 0.45,
      "35-44": 0.25,
      "45+": 0.15
    },
    "gender_split": {
      "male": 0.52,
      "female": 0.48
    },
    "active_hours": [
      {"hour": 18, "percentage": 0.15},
      {"hour": 19, "percentage": 0.22}
    ]
  }
}
```

---

## Relationships to Other Object Types

### Ownership

```yaml
owned_by: User
  description: "User who owns/connected this social account"
  cardinality: "N:1 (many accounts, one owner)"
  implementation: "user_id foreign key"
  cascade: "ON DELETE CASCADE"
  note: "One user can have multiple social accounts on same platform"

managed_by: Integration
  description: "Integration managing data sync for this account"
  cardinality: "N:1 (many accounts, one integration per account)"
  implementation: "integration_id foreign key"
  cascade: "ON DELETE SET NULL"
```

### Content

```yaml
published_posts: SocialPost
  description: "Posts published by this account"
  cardinality: "1:N (one account, many posts)"
  implementation: "SocialPost.account_id foreign key"
  reverse: "account"

has_profile_picture: Media
  description: "Archived profile picture"
  cardinality: "N:1 (many accounts can share same picture)"
  implementation: "profile_picture_media_id foreign key"
  cascade: "ON DELETE SET NULL"
```

### Social Graph (Future)

```yaml
follows: SocialAccount
  description: "Accounts this account follows (if data available)"
  cardinality: "M:N (many to many)"
  implementation: "account_follows join table"
  data_availability: "Dependent on platform API access"

followed_by: SocialAccount
  description: "Accounts following this account"
  cardinality: "M:N (many to many)"
  implementation: "Reverse of follows relationship"
```

---

## API Endpoints

### Account Connection

```http
POST /api/v1/social/accounts
  Description: Connect new social media account
  Headers:
    Authorization: Bearer {access_token}
  Request Body:
    {
      "platform": "instagram",
      "integration_id": "integration-uuid",
      "platform_user_id": "1234567890",
      "username": "johndoe",
      "display_name": "John Doe",
      "bio": "Travel photographer",
      "follower_count": 1250,
      "following_count": 450,
      "post_count": 342
    }
  Response: 201 Created
    {
      "id": "account-uuid",
      "platform": "instagram",
      "username": "johndoe",
      "follower_count": 1250,
      "created_at": "2026-02-09T15:00:00Z"
    }
  Behavior:
    - Deduplicate by (platform, platform_user_id)
    - Download and archive profile picture
    - Initialize follower tracking
```

### Account Retrieval

```http
GET /api/v1/social/accounts/{id}
  Description: Get social account details
  Headers:
    Authorization: Bearer {access_token}
  Response: 200 OK
    {complete account object with analytics}
  Privacy:
    - Only owner can access
    - Returns 404 if not found or unauthorized

GET /api/v1/social/accounts/{id}/posts
  Description: Get posts from this account
  Headers:
    Authorization: Bearer {access_token}
  Query Parameters:
    limit: 50
    offset: 0
    date_from: 2024-01-01
    date_to: 2024-12-31
  Response: 200 OK
    {
      "posts": [{post objects}],
      "total": 342,
      "account": {account summary}
    }

GET /api/v1/social/accounts/{id}/analytics
  Description: Get account growth and engagement analytics
  Headers:
    Authorization: Bearer {access_token}
  Query Parameters:
    period: 30d|90d|1y|all (default: 30d)
  Response: 200 OK
    {
      "follower_growth": {
        "current": 1250,
        "start": 1045,
        "change": 205,
        "change_percent": 19.6,
        "timeline": [{date, count}]
      },
      "engagement": {
        "avg_likes": 120,
        "avg_comments": 15,
        "engagement_rate": 0.0456
      },
      "posting_activity": {
        "total_posts": 42,
        "avg_per_week": 4.2,
        "best_performing": [{post objects}]
      }
    }
```

### Account Management

```http
PATCH /api/v1/social/accounts/{id}
  Description: Update account metadata (manual override or sync)
  Headers:
    Authorization: Bearer {access_token}
  Request Body:
    {
      "username": "new_username",
      "display_name": "New Name",
      "bio": "Updated bio",
      "follower_count": 1300,
      "is_private": true
    }
  Response: 200 OK
    {updated account object}
  Behavior:
    - Username changes added to username_history
    - Follower count changes added to follower_history
    - Updates last_synced_at if from integration sync

DELETE /api/v1/social/accounts/{id}
  Description: Soft delete social account
  Headers:
    Authorization: Bearer {access_token}
  Response: 204 No Content
  Behavior:
    - Sets deleted_at timestamp
    - Account and posts preserved
    - Stops future syncing
    - Can be restored

POST /api/v1/social/accounts/{id}/sync
  Description: Trigger manual sync of account data
  Headers:
    Authorization: Bearer {access_token}
  Response: 202 Accepted
    {
      "job_id": "sync-job-uuid",
      "status": "processing"
    }
  Behavior:
    - Queue async job to sync profile and posts
    - Update metrics and fetch new posts
    - Return job ID for status checking
```

### Bulk Operations

```http
GET /api/v1/social/accounts
  Description: List user's connected social accounts
  Headers:
    Authorization: Bearer {access_token}
  Query Parameters:
    platform: instagram|twitter|linkedin (filter by platform)
    account_type: personal|business|creator
    is_active: true|false
    sort: follower_count|post_count|created_at
    order: asc|desc (default: desc)
  Response: 200 OK
    {
      "accounts": [{account objects}],
      "total": 5,
      "by_platform": {
        "instagram": 2,
        "twitter": 1,
        "linkedin": 1,
        "facebook": 1
      }
    }

GET /api/v1/social/accounts/timeline
  Description: Unified timeline across all accounts
  Headers:
    Authorization: Bearer {access_token}
  Query Parameters:
    limit: 50
    offset: 0
    platforms: instagram,twitter (comma-separated)
  Response: 200 OK
    {
      "posts": [{posts from all accounts}],
      "total": 1543
    }
```

---

## Database Schema (SQLAlchemy Model Reference)

```python
from sqlalchemy import (
    Column, String, Integer, Decimal, Enum as SQLEnum,
    DateTime, Boolean, ForeignKey, Index, CheckConstraint, Text
)
from sqlalchemy.dialects.postgresql import UUID, JSONB
from sqlalchemy.orm import relationship
from app.models.base import BaseObject

class SocialAccount(BaseObject):
    """
    Social media account/profile

    Inherits from BaseObject: id, user_id, created_at, updated_at, deleted_at, metadata
    """

    __tablename__ = "social_accounts"

    # Account Identity (Required)
    platform = Column(
        String(50),
        nullable=False,
        index=True,
        doc="Social media platform"
    )
    platform_user_id = Column(
        String(200),
        nullable=False,
        index=True,
        doc="Unique user ID from platform"
    )
    username = Column(
        String(200),
        nullable=False,
        index=True,
        doc="Current username/handle"
    )
    account_type = Column(
        SQLEnum('personal', 'business', 'creator', 'professional', 'public',
                name='social_account_type_enum'),
        nullable=False,
        index=True,
        default='personal',
        doc="Type of account"
    )

    # Profile Information (Optional)
    display_name = Column(
        String(200),
        nullable=True,
        doc="Display name on platform"
    )
    bio = Column(
        Text,
        nullable=True,
        doc="Account biography"
    )
    profile_picture_url = Column(
        String(1000),
        nullable=True,
        doc="URL to current profile picture"
    )
    profile_picture_media_id = Column(
        UUID(as_uuid=True),
        ForeignKey('media.id', ondelete='SET NULL'),
        nullable=True,
        doc="Archived profile picture"
    )
    website = Column(
        String(500),
        nullable=True,
        doc="Website URL from profile"
    )

    # Account Status (Optional)
    is_verified = Column(
        Boolean,
        nullable=False,
        default=False,
        doc="Platform verification status"
    )
    is_private = Column(
        Boolean,
        nullable=False,
        default=False,
        doc="Whether account is private"
    )
    is_active = Column(
        Boolean,
        nullable=False,
        default=True,
        index=True,
        doc="Whether account is active on platform"
    )
    account_created_at = Column(
        DateTime(timezone=True),
        nullable=True,
        doc="When account was created on platform"
    )

    # Follower Metrics (Optional)
    follower_count = Column(
        Integer,
        nullable=False,
        default=0,
        index=True,
        doc="Current follower count"
    )
    following_count = Column(
        Integer,
        nullable=False,
        default=0,
        index=True,
        doc="Current following count"
    )
    post_count = Column(
        Integer,
        nullable=False,
        default=0,
        index=True,
        doc="Total post count"
    )

    # Engagement Metrics (Optional)
    avg_likes = Column(
        Integer,
        nullable=True,
        doc="Average likes per post"
    )
    avg_comments = Column(
        Integer,
        nullable=True,
        doc="Average comments per post"
    )
    engagement_rate = Column(
        Numeric(5, 4),
        nullable=True,
        doc="Average engagement rate"
    )

    # Platform-Specific (Optional)
    category = Column(
        String(100),
        nullable=True,
        index=True,
        doc="Account category"
    )
    location = Column(
        String(500),
        nullable=True,
        doc="Location from profile"
    )
    email = Column(
        String(255),
        nullable=True,
        doc="Public email from profile"
    )
    phone = Column(
        String(50),
        nullable=True,
        doc="Public phone from profile"
    )

    # Integration Connection (Optional)
    integration_id = Column(
        UUID(as_uuid=True),
        ForeignKey('integrations.id', ondelete='SET NULL'),
        nullable=True,
        index=True,
        doc="Integration managing this account"
    )
    last_synced_at = Column(
        DateTime(timezone=True),
        nullable=True,
        doc="Last successful sync timestamp"
    )
    sync_enabled = Column(
        Boolean,
        nullable=False,
        default=True,
        doc="Whether to continue syncing"
    )

    # External Links (Optional)
    profile_url = Column(
        String(1000),
        nullable=True,
        index=True,
        doc="Public URL to profile"
    )

    # Relationships
    owner = relationship("User", foreign_keys=[BaseObject.user_id])
    integration = relationship("Integration", foreign_keys=[integration_id])
    profile_picture = relationship("Media", foreign_keys=[profile_picture_media_id])

    posts = relationship(
        "SocialPost",
        back_populates="account",
        foreign_keys="SocialPost.account_id"
    )

    # Table Constraints
    __table_args__ = (
        # Composite unique constraint (prevent duplicate accounts)
        Index('idx_social_accounts_unique',
              'platform', 'platform_user_id',
              unique=True),

        # Follower counts must be non-negative
        CheckConstraint('follower_count >= 0', name='check_follower_count'),
        CheckConstraint('following_count >= 0', name='check_following_count'),
        CheckConstraint('post_count >= 0', name='check_post_count'),

        # Composite indexes
        Index('idx_social_accounts_user_platform', 'user_id', 'platform'),
        Index('idx_social_accounts_username', 'username'),
        Index('idx_social_accounts_followers', 'follower_count'),
    )

    def __repr__(self):
        return f"<SocialAccount(id={self.id}, platform={self.platform}, username={self.username})>"

    @property
    def follower_to_following_ratio(self):
        """Calculate follower to following ratio"""
        if self.following_count == 0:
            return None
        return self.follower_count / self.following_count

    @property
    def profile_completeness(self):
        """Calculate profile completeness percentage"""
        fields = [
            self.display_name,
            self.bio,
            self.profile_picture_media_id,
            self.website,
            self.location
        ]
        filled = sum(1 for f in fields if f)
        return (filled / len(fields)) * 100
```

---

## Privacy and Security Considerations

### Access Control

1. **Ownership Enforcement**
   - Accounts only accessible by owner
   - No public sharing of account data
   - Platform credentials never stored

2. **Data Preservation**
   - Complete account history preserved
   - Username changes tracked
   - Profile updates archived

### Data Protection

1. **Sensitive Information**
   - Email and phone from profile (if public on platform)
   - No password or authentication tokens stored
   - OAuth tokens encrypted separately in Integration

2. **Historical Tracking**
   - Follower count history for growth analysis
   - Username history for identity continuity
   - Bio and profile picture history

3. **GDPR Compliance**
   - User can export all account data
   - User can delete accounts (soft delete)
   - Platform data sourced from public APIs only

---

## Validation Rules

### On Connection

```yaml
platform:
  - Must be valid platform identifier
  - Required

platform_user_id:
  - Required
  - Must be unique per platform

username:
  - Required
  - Maximum 200 characters

follower_counts:
  - Must be >= 0
  - Default to 0 if not provided
```

### On Update

```yaml
immutable_fields:
  - id, user_id
  - platform, platform_user_id
  - created_at

mutable_fields:
  - username (tracked in history)
  - display_name, bio, website
  - follower_count, following_count, post_count
  - All engagement metrics
  - Profile picture

username_changes:
  - Add to metadata.username_history
  - Include timestamp of change
```

---

## Use Cases and Examples

### Example 1: Instagram Business Account

```json
{
  "id": "account-550e8400-e29b-41d4-a716-446655440000",
  "user_id": "user-uuid",
  "platform": "instagram",
  "platform_user_id": "1234567890",
  "username": "johndoe.photography",
  "account_type": "business",
  "display_name": "John Doe Photography",
  "bio": "Travel photographer | Based in SF | @canon partner",
  "profile_picture_url": "https://instagram.com/...",
  "profile_picture_media_id": "media-uuid",
  "website": "https://johndoe.com",
  "is_verified": false,
  "is_private": false,
  "is_active": true,
  "account_created_at": "2019-03-15T10:00:00Z",
  "follower_count": 12450,
  "following_count": 890,
  "post_count": 542,
  "avg_likes": 320,
  "avg_comments": 28,
  "engagement_rate": 0.0280,
  "category": "Photographer",
  "location": "San Francisco, CA",
  "email": "contact@johndoe.com",
  "integration_id": "integration-uuid",
  "last_synced_at": "2026-02-09T08:00:00Z",
  "sync_enabled": true,
  "profile_url": "https://www.instagram.com/johndoe.photography/",
  "metadata": {
    "platform_data": {
      "instagram": {
        "account_type": "BUSINESS",
        "category": "Photographer"
      }
    },
    "follower_history": [
      {"date": "2024-01-01", "count": 10200},
      {"date": "2024-02-01", "count": 10850},
      {"date": "2026-02-01", "count": 12300}
    ]
  },
  "created_at": "2024-01-10T12:00:00Z",
  "updated_at": "2026-02-09T08:00:00Z"
}
```

### Example 2: Twitter Personal Account

```json
{
  "id": "account-660e8400-e29b-41d4-a716-446655440001",
  "user_id": "user-uuid",
  "platform": "twitter",
  "platform_user_id": "987654321",
  "username": "johndoe",
  "account_type": "personal",
  "display_name": "John Doe",
  "bio": "Tech enthusiast | Photography | Thoughts are my own",
  "follower_count": 2340,
  "following_count": 567,
  "post_count": 1250,
  "is_verified": false,
  "is_private": false,
  "is_active": true,
  "integration_id": "integration-uuid",
  "last_synced_at": "2026-02-09T08:00:00Z",
  "profile_url": "https://twitter.com/johndoe",
  "metadata": {
    "platform_data": {
      "twitter": {
        "screen_name": "johndoe",
        "verified": false,
        "listed_count": 42
      }
    }
  }
}
```

### Example 3: LinkedIn Professional Account

```json
{
  "id": "account-770e8400-e29b-41d4-a716-446655440002",
  "user_id": "user-uuid",
  "platform": "linkedin",
  "platform_user_id": "abc123xyz",
  "username": "johndoe",
  "account_type": "professional",
  "display_name": "John Doe",
  "bio": "CEO at Acme Corp | Technology & Innovation Leader",
  "follower_count": 5670,
  "following_count": 1200,
  "post_count": 89,
  "is_verified": true,
  "location": "San Francisco Bay Area",
  "integration_id": "integration-uuid",
  "profile_url": "https://www.linkedin.com/in/johndoe/",
  "metadata": {
    "platform_data": {
      "linkedin": {
        "headline": "CEO at Acme Corp",
        "industry": "Technology",
        "num_connections": 500
      }
    }
  }
}
```

---

## Lifecycle States

### 1. Connected

```yaml
state: "connected"
is_active: true
sync_enabled: true
behavior:
  - Account linked to Hypernet
  - Regular syncing enabled
  - Metrics updating
transitions:
  - pause_sync -> Paused
  - platform_delete -> Disconnected
  - delete -> Deleted
```

### 2. Paused

```yaml
state: "paused"
sync_enabled: false
behavior:
  - No automatic syncing
  - Historical data preserved
  - Can resume syncing
transitions:
  - resume_sync -> Connected
  - delete -> Deleted
```

### 3. Disconnected

```yaml
state: "disconnected"
is_active: false
behavior:
  - Platform account deleted or deactivated
  - Historical data preserved
  - Cannot sync new data
transitions:
  - delete -> Deleted
```

### 4. Deleted

```yaml
state: "deleted"
deleted_at: not null
behavior:
  - Account hidden from UI
  - Posts preserved
  - Can be restored
transitions:
  - restore -> Connected or Paused
```

---

## Notes for Implementers

### Performance Optimization

1. **Follower Tracking**
   - Store daily snapshots in metadata.follower_history
   - Compress old data (weekly/monthly aggregates)
   - Use time-series database for analytics

2. **Profile Picture Archival**
   ```python
   # Download and store profile picture as Media
   if account.profile_picture_url:
       media = download_and_create_media(account.profile_picture_url)
       account.profile_picture_media_id = media.id
   ```

3. **Analytics Computation**
   - Calculate engagement metrics from recent posts
   - Cache computed analytics (1 hour TTL)
   - Update on sync or manual refresh

### Growth Tracking

```python
def track_follower_growth(account):
    """Add follower count snapshot to history"""
    history = account.metadata.get('follower_history', [])

    # Add daily snapshot
    history.append({
        'date': datetime.utcnow().date().isoformat(),
        'count': account.follower_count,
        'following': account.following_count
    })

    # Keep last 365 days
    history = history[-365:]

    account.metadata['follower_history'] = history
```

---

**Status:** Active - Core Social Type
**Version:** 1.0
**Authority:** 0.0.3 - Social Types
**Created:** 2026-02-09
**Owner:** Hypernet Core (0.*)
