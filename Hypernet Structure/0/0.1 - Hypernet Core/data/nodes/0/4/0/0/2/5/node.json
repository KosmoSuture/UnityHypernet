{
  "address": "0.4.0.0.2.5",
  "type_address": null,
  "data": {
    "name": "Photo.md",
    "type": "file",
    "extension": ".md",
    "path": "C:\\Hypernet\\Hypernet Structure\\0\\0.4 - Object Type Registry\\0.0.2 - Media Types\\Photo.md",
    "size": 17418,
    "content": "# Photo - Image Media Type\n\n**Type ID:** `hypernet.media.photo`\n**Version:** 1.0\n**Category:** 0.0.2 - Media Types\n**Parent:** Media (extends BaseObject)\n**Status:** Active\n**Created:** 2026-02-04\n\n---\n\n## Identity\n\n```yaml\ntype_name: \"Photo\"\ntype_id: \"hypernet.media.photo\"\nversion: \"1.0\"\nparent_type: \"Media\" (which extends BaseObject)\ncategory: \"0.0.2 - Media Types\"\nabstract: false (can be instantiated)\n```\n\n---\n\n## Purpose\n\n### What\n\n**Photo represents digital images** - photographs, screenshots, scanned documents, digital artwork, or any visual content stored as an image file.\n\n### Why\n\nPhotos are central to personal digital life:\n- Primary medium for capturing memories\n- Most common content type across platforms\n- Rich metadata (EXIF, GPS, tags)\n- Foundation for AI analysis (object detection, face recognition)\n- Heavily integrated (Instagram, Google Photos, iCloud, etc.)\n\n### When to Use\n\nUse Photo type for:\n- Camera photographs (JPEG, HEIC, RAW)\n- Screenshots and screen captures\n- Scanned documents stored as images\n- Digital artwork and graphics (PNG, WebP)\n- Social media images\n- Profile pictures and avatars\n\n**Do NOT use for:**\n- Video files (use Video type)\n- PDF documents (use Document type)\n- Multi-page scans (use Document type)\n\n---\n\n## Inherited Fields (from BaseObject)\n\n```yaml\n# See BaseObject.md for complete details\nid: UUID\nuser_id: UUID\ncreated_at: DateTime\nupdated_at: DateTime\ndeleted_at: DateTime (nullable)\nsource_type: String (nullable)\nsource_id: String (nullable)\nmetadata: JSONB\n```\n\n---\n\n## Type-Specific Required Fields\n\n### File Identity\n\n```yaml\nfilename:\n  type: String\n  required: true\n  max_length: 255\n  indexed: false\n  description: \"Original filename\"\n  validation: Not empty, no path separators\n  examples:\n    - \"IMG_2024.jpg\"\n    - \"Screenshot 2024-01-15.png\"\n    - \"vacation_beach.heic\"\n\nmedia_type:\n  type: String (Enum)\n  required: true\n  fixed_value: \"photo\"\n  indexed: true\n  description: \"Discriminator for media subtypes\"\n  note: \"Always 'photo' for Photo objects\"\n\nmime_type:\n  type: String\n  required: true\n  max_length: 100\n  indexed: true\n  description: \"MIME type of the image file\"\n  allowed_values:\n    - \"image/jpeg\"\n    - \"image/png\"\n    - \"image/heic\"\n    - \"image/heif\"\n    - \"image/webp\"\n    - \"image/gif\"\n    - \"image/tiff\"\n    - \"image/bmp\"\n  examples:\n    - \"image/jpeg\" (most common)\n    - \"image/png\" (screenshots, graphics)\n    - \"image/heic\" (iPhone photos)\n```\n\n### File Storage\n\n```yaml\nfile_size:\n  type: Integer\n  required: true\n  indexed: false\n  min: 1\n  max: 104857600 (100MB, configurable)\n  description: \"Size of image file in bytes\"\n  examples:\n    - 2048576 (2MB JPEG)\n    - 524288 (512KB PNG)\n\nfile_path:\n  type: String\n  required: true\n  max_length: 512\n  indexed: false\n  description: \"Relative path to file on storage\"\n  pattern: \"/media/{user_id}/{year}/{month}/{filename}\"\n  examples:\n    - \"/media/user-123/2024/01/IMG_2024.jpg\"\n    - \"/media/ai-456/2024/01/generated_image.png\"\n\nhash:\n  type: String\n  required: true\n  length: 64\n  indexed: true\n  description: \"SHA-256 hash for deduplication\"\n  format: \"Lowercase hexadecimal\"\n  use_case: \"Detect duplicate uploads\"\n  example: \"a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3\"\n```\n\n---\n\n## Type-Specific Optional Fields\n\n### Image Dimensions\n\n```yaml\nwidth:\n  type: Integer\n  required: false\n  nullable: true\n  min: 1\n  max: 50000\n  description: \"Image width in pixels\"\n  examples:\n    - 4032 (iPhone 14 Pro)\n    - 1920 (Full HD screenshot)\n\nheight:\n  type: Integer\n  required: false\n  nullable: true\n  min: 1\n  max: 50000\n  description: \"Image height in pixels\"\n  examples:\n    - 3024 (iPhone 14 Pro)\n    - 1080 (Full HD screenshot)\n```\n\n### Temporal Data\n\n```yaml\ntaken_at:\n  type: DateTime\n  required: false\n  nullable: true\n  timezone: true (UTC)\n  description: \"When photo was captured (not uploaded)\"\n  source: \"Extracted from EXIF or user-provided\"\n  note: \"Different from created_at (which is upload time)\"\n  examples:\n    - \"2024-01-15T14:30:00Z\" (EXIF timestamp)\n    - \"2023-12-25T09:00:00Z\" (Christmas morning photo)\n```\n\n### Geolocation\n\n```yaml\ngps_latitude:\n  type: Float\n  required: false\n  nullable: true\n  min: -90.0\n  max: 90.0\n  description: \"Latitude where photo was taken\"\n  source: \"Extracted from EXIF GPS data\"\n  examples:\n    - 37.7749 (San Francisco)\n    - -33.8688 (Sydney)\n\ngps_longitude:\n  type: Float\n  required: false\n  nullable: true\n  min: -180.0\n  max: 180.0\n  description: \"Longitude where photo was taken\"\n  source: \"Extracted from EXIF GPS data\"\n  examples:\n    - -122.4194 (San Francisco)\n    - 151.2093 (Sydney)\n```\n\n### Processing\n\n```yaml\nprocessing_status:\n  type: String (Enum)\n  required: false\n  nullable: true\n  default: \"pending\"\n  indexed: true\n  description: \"Status of post-upload processing\"\n  allowed_values:\n    - \"pending\" (upload complete, processing not started)\n    - \"processing\" (extracting EXIF, generating thumbnails)\n    - \"ready\" (fully processed and available)\n    - \"error\" (processing failed)\n  examples:\n    - \"ready\" (most photos)\n    - \"processing\" (large uploads)\n\nthumbnail_path:\n  type: String\n  required: false\n  nullable: true\n  max_length: 512\n  description: \"Path to generated thumbnail\"\n  pattern: \"/media/{user_id}/{year}/{month}/{filename}_thumb.jpg\"\n  size: \"Usually 300x300 or 400x400\"\n  examples:\n    - \"/media/user-123/2024/01/IMG_2024_thumb.jpg\"\n```\n\n---\n\n## Metadata Schema\n\nThe `metadata` JSONB field contains extensible photo-specific data:\n\n### EXIF Data\n\n```json\n{\n  \"exif\": {\n    \"camera_make\": \"Apple\",\n    \"camera_model\": \"iPhone 14 Pro\",\n    \"lens_make\": \"Apple\",\n    \"lens_model\": \"iPhone 14 Pro back dual wide camera 6.86mm f/1.78\",\n    \"f_number\": 1.78,\n    \"exposure_time\": \"1/120\",\n    \"iso\": 100,\n    \"focal_length\": 6.86,\n    \"flash\": false,\n    \"orientation\": 1,\n    \"software\": \"iOS 17.2\",\n    \"date_time_original\": \"2024:01:15 14:30:00\"\n  }\n}\n```\n\n### User Tags\n\n```json\n{\n  \"tags\": [\n    \"vacation\",\n    \"beach\",\n    \"sunset\",\n    \"san francisco\"\n  ]\n}\n```\n\n### AI Analysis\n\n```json\n{\n  \"ai_labels\": [\n    \"beach\",\n    \"ocean\",\n    \"sky\",\n    \"sunset\",\n    \"outdoor\"\n  ],\n  \"ai_confidence\": {\n    \"beach\": 0.95,\n    \"ocean\": 0.92,\n    \"sky\": 0.98\n  },\n  \"faces\": [\n    {\n      \"person_id\": \"person-uuid-123\",\n      \"bbox\": [100, 150, 200, 250],\n      \"confidence\": 0.89\n    }\n  ],\n  \"objects\": [\n    {\n      \"label\": \"surfboard\",\n      \"bbox\": [300, 400, 150, 80],\n      \"confidence\": 0.76\n    }\n  ]\n}\n```\n\n### Platform-Specific (Instagram)\n\n```json\n{\n  \"instagram\": {\n    \"post_id\": \"instagram:Abc123Xyz\",\n    \"post_url\": \"https://instagram.com/p/Abc123Xyz\",\n    \"caption\": \"Beautiful sunset at the beach! \ud83c\udf05\",\n    \"likes_count\": 142,\n    \"comments_count\": 23,\n    \"filter\": \"valencia\",\n    \"posted_at\": \"2024-01-15T20:00:00Z\"\n  }\n}\n```\n\n### Processing Details\n\n```json\n{\n  \"processing\": {\n    \"thumbnail_generated\": true,\n    \"exif_extracted\": true,\n    \"ai_analysis_completed\": true,\n    \"face_detection_completed\": false,\n    \"processing_duration_ms\": 1245\n  }\n}\n```\n\n---\n\n## Relationships (Link Types)\n\n### Outgoing Links (Photo \u2192 Other Objects)\n\n```yaml\ncontains:\n  - None (photos don't contain other objects)\n\nsource:\n  - Integration (photo synced from Instagram, Google Photos, etc.)\n  - \"Photo --source--> Integration\"\n\nduplicate_of:\n  - Photo (same content, different upload)\n  - \"Photo --duplicate_of--> Photo (original)\"\n\nvariant_of:\n  - Photo (edited version, different size)\n  - \"Photo (edited) --variant_of--> Photo (original)\"\n\nrelated_to:\n  - Photo (similar content, same event)\n  - Video (same event)\n  - Location (where taken)\n  - CalendarEvent (when taken)\n  - Person (who's in photo)\n  - \"Photo --related_to--> {Photo|Video|Location|Event|Person}\"\n```\n\n### Incoming Links (Other Objects \u2192 Photo)\n\n```yaml\ncontains:\n  - Album (photo is in album)\n  - \"Album --contains--> Photo\"\n\nreferenced_by:\n  - SocialPost (photo is in post)\n  - Email (photo attached to email)\n  - ChatMessage (photo shared in chat)\n  - Document (photo embedded in document)\n  - \"Post --referenced_by--> Photo\"\n\nprofile_image_of:\n  - User (photo is profile picture)\n  - SocialAccount (photo is avatar)\n  - \"User --profile_image_of--> Photo\"\n```\n\n---\n\n## Validation Rules\n\n### On Upload/Creation\n\n```yaml\nfilename:\n  - Not empty\n  - No path separators (/, \\)\n  - Max 255 characters\n  - Suggested format: original filename or generated unique name\n\nmedia_type:\n  - Must be exactly \"photo\"\n\nmime_type:\n  - Must be in allowed list\n  - Must match actual file content (validated server-side)\n\nfile_size:\n  - Must be > 0\n  - Must be <= max_upload_size (100MB default, configurable)\n\nfile_path:\n  - Must be unique\n  - Must follow pattern /media/{user_id}/{year}/{month}/...\n  - File must exist on disk after upload\n\nhash:\n  - Must be 64-character lowercase hex (SHA-256)\n  - Calculated server-side from file content\n  - Used to detect duplicates\n\nwidth, height:\n  - If provided, must be > 0 and <= 50000\n  - Auto-extracted from image if not provided\n\ngps_latitude:\n  - If provided, must be >= -90 and <= 90\n\ngps_longitude:\n  - If provided, must be >= -180 and <= 180\n\nprocessing_status:\n  - Must be one of: pending, processing, ready, error\n\nmetadata:\n  - Must be valid JSON object\n  - Max 1MB total size\n```\n\n### Constraints\n\n```sql\n-- Check constraints\nCHECK (media_type = 'photo')\nCHECK (file_size > 0 AND file_size <= 104857600)\nCHECK (width IS NULL OR (width > 0 AND width <= 50000))\nCHECK (height IS NULL OR (height > 0 AND height <= 50000))\nCHECK (gps_latitude IS NULL OR (gps_latitude >= -90 AND gps_latitude <= 90))\nCHECK (gps_longitude IS NULL OR (gps_longitude >= -180 AND gps_longitude <= 180))\nCHECK (processing_status IN ('pending', 'processing', 'ready', 'error'))\n\n-- Unique hash per user (same user can't upload same photo twice)\nUNIQUE (user_id, hash)\n\n-- Indexes\nCREATE INDEX idx_photos_mime_type ON photos(mime_type);\nCREATE INDEX idx_photos_hash ON photos(hash);\nCREATE INDEX idx_photos_taken_at ON photos(taken_at) WHERE taken_at IS NOT NULL;\nCREATE INDEX idx_photos_gps ON photos(gps_latitude, gps_longitude)\n  WHERE gps_latitude IS NOT NULL AND gps_longitude IS NOT NULL;\nCREATE INDEX idx_photos_processing_status ON photos(processing_status)\n  WHERE processing_status != 'ready';\n```\n\n---\n\n## API Endpoints\n\n### Upload Photo\n\n```http\nPOST /api/v1/media/upload\nContent-Type: multipart/form-data\n\nBody:\n  file: (binary data)\n  filename: \"IMG_2024.jpg\" (optional, extracted from file if not provided)\n  taken_at: \"2024-01-15T14:30:00Z\" (optional)\n  tags: [\"vacation\", \"beach\"] (optional)\n\nResponse: 201 Created\n{\n  \"id\": \"photo-uuid\",\n  \"user_id\": \"current-user-uuid\",\n  \"filename\": \"IMG_2024.jpg\",\n  \"media_type\": \"photo\",\n  \"mime_type\": \"image/jpeg\",\n  \"file_size\": 2048576,\n  \"file_path\": \"/media/user-123/2024/01/IMG_2024.jpg\",\n  \"hash\": \"a665a459...\",\n  \"width\": 4032,\n  \"height\": 3024,\n  \"taken_at\": \"2024-01-15T14:30:00Z\",\n  \"gps_latitude\": 37.7749,\n  \"gps_longitude\": -122.4194,\n  \"processing_status\": \"processing\",\n  \"thumbnail_path\": null,\n  \"created_at\": \"2024-01-15T15:00:00Z\",\n  \"updated_at\": \"2024-01-15T15:00:00Z\",\n  \"deleted_at\": null,\n  \"source_type\": \"upload\",\n  \"source_id\": null,\n  \"metadata\": {\n    \"tags\": [\"vacation\", \"beach\"]\n  }\n}\n```\n\n### Get Photo\n\n```http\nGET /api/v1/media/{id}\n\nResponse: 200 OK\n{full photo object}\n```\n\n### Get Photo File\n\n```http\nGET /api/v1/media/{id}/file\n\nResponse: 200 OK\nContent-Type: image/jpeg\nContent-Disposition: inline; filename=\"IMG_2024.jpg\"\n\n(binary image data)\n```\n\n### Get Thumbnail\n\n```http\nGET /api/v1/media/{id}/thumbnail\n\nResponse: 200 OK\nContent-Type: image/jpeg\n\n(thumbnail binary data)\n```\n\n### List Photos\n\n```http\nGET /api/v1/media?media_type=photo&limit=50&offset=0\n\nResponse: 200 OK\n{\n  \"items\": [\n    {photo object},\n    {photo object},\n    ...\n  ],\n  \"total\": 1543,\n  \"limit\": 50,\n  \"offset\": 0\n}\n```\n\n### Update Photo Metadata\n\n```http\nPATCH /api/v1/media/{id}\nContent-Type: application/json\n\n{\n  \"metadata\": {\n    \"tags\": [\"vacation\", \"beach\", \"sunset\"]\n  }\n}\n\nResponse: 200 OK\n{updated photo object}\n```\n\n### Delete Photo\n\n```http\nDELETE /api/v1/media/{id}\n\nResponse: 204 No Content\n(Photo soft-deleted, file remains on disk)\n```\n\n### Search Photos\n\n```http\nGET /api/v1/media/search?q=beach&media_type=photo&limit=20\n\nResponse: 200 OK\n{\n  \"items\": [\n    {photos matching \"beach\" in tags, AI labels, or EXIF}\n  ],\n  \"total\": 47,\n  \"limit\": 20,\n  \"offset\": 0\n}\n```\n\n---\n\n## Implementation\n\n### SQLAlchemy Model\n\n```python\nfrom sqlalchemy import Column, String, Integer, Float, DateTime, CheckConstraint, Index\nfrom app.models.base import BaseObject\n\nclass Photo(BaseObject):\n    \"\"\"Photo/image media type\"\"\"\n\n    __tablename__ = \"photos\"\n\n    # File Identity\n    filename = Column(String(255), nullable=False)\n    media_type = Column(String(50), nullable=False, default='photo')\n    mime_type = Column(String(100), nullable=False, index=True)\n\n    # File Storage\n    file_size = Column(Integer, nullable=False)\n    file_path = Column(String(512), nullable=False, unique=True)\n    hash = Column(String(64), nullable=False, index=True)\n\n    # Image Dimensions\n    width = Column(Integer, nullable=True)\n    height = Column(Integer, nullable=True)\n\n    # Temporal\n    taken_at = Column(DateTime(timezone=True), nullable=True, index=True)\n\n    # Geolocation\n    gps_latitude = Column(Float, nullable=True)\n    gps_longitude = Column(Float, nullable=True)\n\n    # Processing\n    processing_status = Column(\n        String(50),\n        nullable=True,\n        default='pending',\n        index=True\n    )\n    thumbnail_path = Column(String(512), nullable=True)\n\n    # Constraints\n    __table_args__ = (\n        CheckConstraint(\"media_type = 'photo'\", name='chk_media_type_photo'),\n        CheckConstraint(\"file_size > 0 AND file_size <= 104857600\", name='chk_file_size'),\n        CheckConstraint(\"width IS NULL OR (width > 0 AND width <= 50000)\", name='chk_width'),\n        CheckConstraint(\"height IS NULL OR (height > 0 AND height <= 50000)\", name='chk_height'),\n        CheckConstraint(\"gps_latitude IS NULL OR (gps_latitude >= -90 AND gps_latitude <= 90)\", name='chk_latitude'),\n        CheckConstraint(\"gps_longitude IS NULL OR (gps_longitude >= -180 AND gps_longitude <= 180)\", name='chk_longitude'),\n        CheckConstraint(\"processing_status IN ('pending', 'processing', 'ready', 'error')\", name='chk_processing_status'),\n        Index('idx_photos_user_hash', 'user_id', 'hash', unique=True),\n        Index('idx_photos_gps', 'gps_latitude', 'gps_longitude', postgresql_where=Column('gps_latitude').isnot(None)),\n    )\n\n    def __repr__(self):\n        return f\"<Photo(id={self.id}, filename={self.filename})>\"\n```\n\n---\n\n## Examples\n\n### Simple Photo Upload\n\n```json\n{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"user_id\": \"user-123\",\n  \"filename\": \"IMG_2024.jpg\",\n  \"media_type\": \"photo\",\n  \"mime_type\": \"image/jpeg\",\n  \"file_size\": 2048576,\n  \"file_path\": \"/media/user-123/2024/01/IMG_2024.jpg\",\n  \"hash\": \"a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3\",\n  \"width\": 4032,\n  \"height\": 3024,\n  \"taken_at\": \"2024-01-15T14:30:00Z\",\n  \"gps_latitude\": 37.7749,\n  \"gps_longitude\": -122.4194,\n  \"processing_status\": \"ready\",\n  \"thumbnail_path\": \"/media/user-123/2024/01/IMG_2024_thumb.jpg\",\n  \"created_at\": \"2024-01-15T15:00:00Z\",\n  \"updated_at\": \"2024-01-15T15:05:00Z\",\n  \"deleted_at\": null,\n  \"source_type\": \"upload\",\n  \"source_id\": null,\n  \"metadata\": {}\n}\n```\n\n### Instagram Photo (with metadata)\n\n```json\n{\n  \"id\": \"instagram-photo-uuid\",\n  \"user_id\": \"user-456\",\n  \"filename\": \"instagram_Abc123Xyz.jpg\",\n  \"media_type\": \"photo\",\n  \"mime_type\": \"image/jpeg\",\n  \"file_size\": 1524288,\n  \"file_path\": \"/media/user-456/2024/01/instagram_Abc123Xyz.jpg\",\n  \"hash\": \"b775b559...\",\n  \"width\": 1080,\n  \"height\": 1080,\n  \"taken_at\": \"2024-01-14T18:30:00Z\",\n  \"gps_latitude\": null,\n  \"gps_longitude\": null,\n  \"processing_status\": \"ready\",\n  \"thumbnail_path\": \"/media/user-456/2024/01/instagram_Abc123Xyz_thumb.jpg\",\n  \"created_at\": \"2024-01-15T10:00:00Z\",\n  \"updated_at\": \"2024-01-15T10:05:00Z\",\n  \"deleted_at\": null,\n  \"source_type\": \"integration\",\n  \"source_id\": \"instagram:Abc123Xyz\",\n  \"metadata\": {\n    \"instagram\": {\n      \"post_id\": \"Abc123Xyz\",\n      \"post_url\": \"https://instagram.com/p/Abc123Xyz\",\n      \"caption\": \"Beautiful sunset! \ud83c\udf05\",\n      \"likes_count\": 142,\n      \"comments_count\": 23,\n      \"filter\": \"valencia\"\n    },\n    \"tags\": [\"sunset\", \"beach\"],\n    \"ai_labels\": [\"sunset\", \"sky\", \"ocean\"]\n  }\n}\n```\n\n---\n\n**Status:** Active - Phase 1 Priority\n**Version:** 1.0\n**Parent:** Media \u2192 BaseObject\n**Created:** 2026-02-04\n**Authority:** 0.0.2 - Media Types\n"
  },
  "created_at": "2026-02-15T11:54:04.760163+00:00",
  "updated_at": "2026-02-15T11:54:04.760163+00:00",
  "deleted_at": null,
  "source_type": "import",
  "source_id": "file:Photo.md"
}