{
  "address": "0.4.0.0.1.5",
  "type_address": null,
  "data": {
    "name": "BaseObject.md",
    "type": "file",
    "extension": ".md",
    "path": "C:\\Hypernet\\Hypernet Structure\\0\\0.4 - Object Type Registry\\0.0.1 - Core Types\\BaseObject.md",
    "size": 12951,
    "content": "# BaseObject - Universal Parent Type\n\n**Type ID:** `hypernet.core.baseobject`\n**Version:** 1.0\n**Category:** 0.0.1 - Core Types\n**Status:** Canonical - All objects inherit from this\n**Created:** 2026-02-04\n\n---\n\n## Identity\n\n```yaml\ntype_name: \"BaseObject\"\ntype_id: \"hypernet.core.baseobject\"\nversion: \"1.0\"\nparent_type: null (this is the root)\ncategory: \"0.0.1 - Core Types\"\nabstract: true (cannot be instantiated directly)\n```\n\n---\n\n## Purpose\n\n**BaseObject is the universal parent of ALL objects in Hypernet.**\n\nEvery object type (Photo, Email, Transaction, AIPersonality, etc.) inherits these base fields and behaviors.\n\n**Why this matters:**\n- Ensures consistency across all types\n- Provides common functionality (timestamps, soft delete, attribution)\n- Enables universal operations (link any type to any type)\n- Supports extensibility (metadata field)\n\n**When to use:** Never directly - all types inherit from this\n\n---\n\n## Core Fields\n\n### Identity\n\n```yaml\nid:\n  type: UUID\n  required: true\n  unique: true\n  description: \"Globally unique identifier for this object\"\n  generated: true (auto-generated on creation)\n  immutable: true (never changes)\n  format: \"UUID v4\"\n  example: \"550e8400-e29b-41d4-a716-446655440000\"\n```\n\n### Ownership\n\n```yaml\nuser_id:\n  type: UUID\n  required: true\n  indexed: true\n  description: \"Owner of this object (human or AI)\"\n  references: \"User.id\"\n  cascade: \"ON DELETE CASCADE\" (if user deleted, their objects deleted)\n  immutable: false (ownership can be transferred)\n```\n\n### Timestamps\n\n```yaml\ncreated_at:\n  type: DateTime\n  required: true\n  indexed: true\n  timezone: true (UTC)\n  description: \"When this object was created\"\n  generated: true (auto-set on creation)\n  immutable: true (never changes)\n  format: ISO 8601\n  example: \"2024-01-15T14:30:00Z\"\n\nupdated_at:\n  type: DateTime\n  required: true\n  indexed: false\n  timezone: true (UTC)\n  description: \"When this object was last modified\"\n  generated: true (auto-set on creation)\n  auto_update: true (updated on every change)\n  format: ISO 8601\n  example: \"2024-01-15T15:45:00Z\"\n\ndeleted_at:\n  type: DateTime\n  required: false\n  indexed: true\n  nullable: true\n  timezone: true (UTC)\n  description: \"When this object was soft-deleted (null = not deleted)\"\n  format: ISO 8601\n  example: \"2024-01-20T10:00:00Z\"\n```\n\n### Source Tracking\n\n```yaml\nsource_type:\n  type: String\n  required: false\n  max_length: 50\n  indexed: true\n  nullable: true\n  description: \"Where this object came from\"\n  examples:\n    - \"upload\" (user uploaded)\n    - \"integration\" (synced from external service)\n    - \"api\" (created via API)\n    - \"import\" (bulk import)\n    - \"ai_generated\" (created by AI)\n\nsource_id:\n  type: String\n  required: false\n  max_length: 255\n  indexed: true\n  nullable: true\n  description: \"External identifier at the source\"\n  examples:\n    - \"instagram:12345\" (Instagram post ID)\n    - \"gdrive:abc123\" (Google Drive file ID)\n    - \"import_batch:2024-01-15\"\n```\n\n### Extensibility\n\n```yaml\nmetadata:\n  type: JSONB\n  required: true\n  default: {} (empty object)\n  indexed: false (but can index specific keys)\n  description: \"Extensible field for type-specific data\"\n  validation: Must be valid JSON object\n  max_size: 1MB (configurable)\n  examples:\n    - Photo: {\"exif\": {...}, \"tags\": [...]}\n    - Email: {\"headers\": {...}, \"thread_id\": \"...\"}\n    - Transaction: {\"merchant\": \"...\", \"category\": \"...\"}\n```\n\n---\n\n## Behaviors\n\n### Soft Delete\n\nAll objects support soft delete:\n- `DELETE` sets `deleted_at` to current timestamp\n- Object remains in database but filtered from queries\n- Can be restored by setting `deleted_at` to null\n- Permanent deletion (hard delete) requires explicit admin action\n\n**Implementation:**\n```python\ndef soft_delete(obj):\n    obj.deleted_at = datetime.utcnow()\n    obj.save()\n\ndef restore(obj):\n    obj.deleted_at = None\n    obj.save()\n\ndef is_deleted(obj):\n    return obj.deleted_at is not None\n```\n\n### Ownership Transfer\n\nObjects can change owners:\n```python\ndef transfer_ownership(obj, new_user_id):\n    obj.user_id = new_user_id\n    obj.updated_at = datetime.utcnow()\n    obj.save()\n```\n\n**Use cases:**\n- Shared albums (transfer to shared account)\n- AI contributions (transfer to organization)\n- Account merging\n\n### Metadata Extension\n\nAny type can store additional data in metadata without schema changes:\n```python\ndef add_metadata(obj, key, value):\n    obj.metadata[key] = value\n    obj.updated_at = datetime.utcnow()\n    obj.save()\n\ndef get_metadata(obj, key, default=None):\n    return obj.metadata.get(key, default)\n```\n\n---\n\n## Validation Rules\n\n### On Creation\n\n```yaml\nid: Must be valid UUID v4\nuser_id: Must reference existing User\ncreated_at: Auto-set to current UTC time\nupdated_at: Auto-set to current UTC time (same as created_at initially)\ndeleted_at: Must be null\nmetadata: Must be valid JSON object, max 1MB\n```\n\n### On Update\n\n```yaml\nid: Cannot be changed\ncreated_at: Cannot be changed\nupdated_at: Auto-set to current UTC time\nuser_id: Can change only via explicit ownership transfer\ndeleted_at: Can be set (soft delete) or cleared (restore)\nmetadata: Must remain valid JSON object, max 1MB\n```\n\n### Database Constraints\n\n```sql\n-- Primary key\nPRIMARY KEY (id)\n\n-- Foreign key\nFOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n\n-- Check constraints\nCHECK (created_at <= updated_at)\nCHECK (deleted_at IS NULL OR deleted_at >= created_at)\n\n-- Indexes\nCREATE INDEX idx_baseobject_user_id ON table_name(user_id);\nCREATE INDEX idx_baseobject_created_at ON table_name(created_at);\nCREATE INDEX idx_baseobject_deleted_at ON table_name(deleted_at)\n  WHERE deleted_at IS NOT NULL; -- Partial index\nCREATE INDEX idx_baseobject_source ON table_name(source_type, source_id);\n```\n\n---\n\n## Relationships\n\nBaseObject can participate in Link relationships:\n```yaml\nOutgoing Links:\n  - Any link type to any object type\n\nIncoming Links:\n  - Any link type from any object type\n\nNote: Specific allowed relationships are defined by child types\n```\n\n---\n\n## API Patterns\n\nAll types inheriting from BaseObject get standard APIs:\n\n### Create\n\n```http\nPOST /api/v1/{type_plural}\nContent-Type: application/json\n\n{\n  \"field1\": \"value1\",\n  \"field2\": \"value2\",\n  ...\n}\n\nResponse: 201 Created\n{\n  \"id\": \"uuid\",\n  \"user_id\": \"current_user_uuid\",\n  \"created_at\": \"timestamp\",\n  \"updated_at\": \"timestamp\",\n  \"deleted_at\": null,\n  \"source_type\": \"api\",\n  \"source_id\": null,\n  \"metadata\": {},\n  \"field1\": \"value1\",\n  \"field2\": \"value2\",\n  ...\n}\n```\n\n### Read\n\n```http\nGET /api/v1/{type_plural}/{id}\n\nResponse: 200 OK\n{object with all fields}\n```\n\n### List\n\n```http\nGET /api/v1/{type_plural}?limit=50&offset=0&include_deleted=false\n\nResponse: 200 OK\n{\n  \"items\": [{object}, {object}, ...],\n  \"total\": 150,\n  \"limit\": 50,\n  \"offset\": 0\n}\n```\n\n### Update\n\n```http\nPATCH /api/v1/{type_plural}/{id}\nContent-Type: application/json\n\n{\n  \"field1\": \"new_value\"\n}\n\nResponse: 200 OK\n{updated object with updated_at changed}\n```\n\n### Delete (Soft)\n\n```http\nDELETE /api/v1/{type_plural}/{id}\n\nResponse: 204 No Content\n(Object's deleted_at is set to current time)\n```\n\n### Restore\n\n```http\nPOST /api/v1/{type_plural}/{id}/restore\n\nResponse: 200 OK\n{restored object with deleted_at = null}\n```\n\n---\n\n## Implementation\n\n### SQLAlchemy Model (Python)\n\n```python\nfrom sqlalchemy import Column, String, DateTime, ForeignKey, func\nfrom sqlalchemy.dialects.postgresql import UUID, JSONB\nfrom sqlalchemy.ext.declarative import declarative_base\nimport uuid\n\nBase = declarative_base()\n\nclass BaseObject(Base):\n    \"\"\"Universal parent class for all Hypernet objects\"\"\"\n\n    __abstract__ = True  # This class is not instantiated directly\n\n    # Identity\n    id = Column(UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)\n\n    # Ownership\n    user_id = Column(\n        UUID(as_uuid=True),\n        ForeignKey(\"users.id\", ondelete=\"CASCADE\"),\n        nullable=False,\n        index=True\n    )\n\n    # Timestamps\n    created_at = Column(\n        DateTime(timezone=True),\n        nullable=False,\n        server_default=func.now()\n    )\n    updated_at = Column(\n        DateTime(timezone=True),\n        nullable=False,\n        server_default=func.now(),\n        onupdate=func.now()\n    )\n    deleted_at = Column(\n        DateTime(timezone=True),\n        nullable=True\n    )\n\n    # Source Tracking\n    source_type = Column(String(50), nullable=True, index=True)\n    source_id = Column(String(255), nullable=True, index=True)\n\n    # Extensibility\n    metadata = Column(JSONB, nullable=False, default={})\n\n    # Behaviors\n    def soft_delete(self):\n        \"\"\"Soft delete this object\"\"\"\n        self.deleted_at = datetime.utcnow()\n\n    def restore(self):\n        \"\"\"Restore a soft-deleted object\"\"\"\n        self.deleted_at = None\n\n    @property\n    def is_deleted(self):\n        \"\"\"Check if object is deleted\"\"\"\n        return self.deleted_at is not None\n\n    def transfer_ownership(self, new_user_id):\n        \"\"\"Transfer ownership to another user\"\"\"\n        self.user_id = new_user_id\n```\n\n### Child Types Example\n\n```python\nclass Photo(BaseObject):\n    \"\"\"Photo type inherits all BaseObject fields\"\"\"\n\n    __tablename__ = \"photos\"\n\n    # Photo-specific fields\n    filename = Column(String(255), nullable=False)\n    media_type = Column(String(50), nullable=False, default='photo')\n    mime_type = Column(String(100), nullable=False)\n    file_size = Column(Integer, nullable=False)\n    # ... etc\n```\n\n---\n\n## Examples\n\n### Minimal Instance\n\n```json\n{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"user_id\": \"user-123-uuid\",\n  \"created_at\": \"2024-01-15T14:30:00Z\",\n  \"updated_at\": \"2024-01-15T14:30:00Z\",\n  \"deleted_at\": null,\n  \"source_type\": \"api\",\n  \"source_id\": null,\n  \"metadata\": {}\n}\n```\n\n### With Metadata\n\n```json\n{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"user_id\": \"user-123-uuid\",\n  \"created_at\": \"2024-01-15T14:30:00Z\",\n  \"updated_at\": \"2024-01-15T16:45:00Z\",\n  \"deleted_at\": null,\n  \"source_type\": \"integration\",\n  \"source_id\": \"instagram:98765\",\n  \"metadata\": {\n    \"sync_timestamp\": \"2024-01-15T16:45:00Z\",\n    \"original_url\": \"https://instagram.com/p/xyz\",\n    \"likes\": 42\n  }\n}\n```\n\n### Soft Deleted\n\n```json\n{\n  \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n  \"user_id\": \"user-123-uuid\",\n  \"created_at\": \"2024-01-15T14:30:00Z\",\n  \"updated_at\": \"2024-01-20T10:00:00Z\",\n  \"deleted_at\": \"2024-01-20T10:00:00Z\",\n  \"source_type\": \"upload\",\n  \"source_id\": null,\n  \"metadata\": {\n    \"delete_reason\": \"user_requested\"\n  }\n}\n```\n\n---\n\n## Migration Path\n\n### Version History\n\n**v1.0 (Current):**\n- Initial definition\n- All fields defined above\n\n**Future versions** would be documented here with migration paths.\n\n---\n\n## Design Rationale\n\n### Why UUID for ID?\n\n- Globally unique (no collisions even across distributed systems)\n- Can be generated client-side\n- No sequential leakage (can't guess other IDs)\n- Portable across databases\n\n### Why Soft Delete?\n\n- Allows recovery from accidental deletions\n- Maintains referential integrity (links remain valid)\n- Enables audit trails\n- Can truly delete later if needed\n\n### Why Metadata Field?\n\n- Infinite extensibility without schema migrations\n- Each type can store unique data\n- Supports rapid iteration\n- JSONB allows efficient queries on metadata\n\n### Why Source Tracking?\n\n- Know where data came from\n- Debug integration issues\n- Handle duplicates intelligently\n- Attribution and provenance\n\n---\n\n## Notes for Implementers\n\n### Query Patterns\n\n**Always exclude deleted by default:**\n```python\ndef get_active_objects(session):\n    return session.query(Object).filter(Object.deleted_at == None)\n```\n\n**Explicit include deleted:**\n```python\ndef get_all_objects(session, include_deleted=False):\n    query = session.query(Object)\n    if not include_deleted:\n        query = query.filter(Object.deleted_at == None)\n    return query\n```\n\n### Indexing Strategy\n\n- Index `user_id` (frequent filtering by owner)\n- Index `created_at` (temporal queries)\n- Partial index on `deleted_at` (only non-null values)\n- Index `(source_type, source_id)` composite (duplicate detection)\n\n### Performance Considerations\n\n- `metadata` is JSONB for performance (indexable, queryable)\n- Use partial indexes to avoid indexing deleted rows\n- Consider partitioning by `created_at` for very large tables\n\n---\n\n**Status:** Canonical - All types inherit from this\n**Version:** 1.0\n**Authority:** 0.0.1 - Core Types\n**Created:** 2026-02-04\n"
  },
  "created_at": "2026-02-15T11:54:04.639121+00:00",
  "updated_at": "2026-02-15T11:54:04.639121+00:00",
  "deleted_at": null,
  "source_type": "import",
  "source_id": "file:BaseObject.md"
}