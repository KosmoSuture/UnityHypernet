{
  "address": "0.1.2.3.0.1.0.12.2.1",
  "type_address": null,
  "data": {
    "name": "node.json",
    "type": "file",
    "extension": ".json",
    "path": "C:\\Hypernet\\Hypernet Structure\\0\\0.1 - Hypernet Core\\data\\nodes\\0\\1\\0\\12\\2\\node.json",
    "size": 16825,
    "content": "{\n  \"address\": \"0.1.0.12.2\",\n  \"type_address\": null,\n  \"data\": {\n    \"name\": \"02-Initial-Migration.sql\",\n    \"type\": \"file\",\n    \"extension\": \".sql\",\n    \"path\": \"C:\\\\Hypernet\\\\Hypernet Structure\\\\0\\\\0.1 - Hypernet Core\\\\0.1.0 - Planning & Documentation\\\\Database-Design\\\\02-Initial-Migration.sql\",\n    \"size\": 16261,\n    \"content\": \"-- Hypernet Core 0.1 - Initial Database Migration\\n-- PostgreSQL 15+\\n-- Run this script to create all tables and indexes\\n\\n-- Enable required extensions\\nCREATE EXTENSION IF NOT EXISTS \\\"uuid-ossp\\\";\\nCREATE EXTENSION IF NOT EXISTS \\\"pgcrypto\\\";\\n\\n-- ==============================================================================\\n-- TRIGGER FUNCTION: Auto-update updated_at timestamp\\n-- ==============================================================================\\n\\nCREATE OR REPLACE FUNCTION update_updated_at_column()\\nRETURNS TRIGGER AS $$\\nBEGIN\\n    NEW.updated_at = NOW();\\n    RETURN NEW;\\nEND;\\n$$ LANGUAGE plpgsql;\\n\\n-- ==============================================================================\\n-- TABLE: users\\n-- ==============================================================================\\n\\nCREATE TABLE users (\\n    -- Identity\\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\\n\\n    -- Authentication\\n    email VARCHAR(255) NOT NULL UNIQUE,\\n    password_hash VARCHAR(255) NOT NULL,\\n    email_verified BOOLEAN NOT NULL DEFAULT FALSE,\\n\\n    -- Profile\\n    display_name VARCHAR(100),\\n    avatar_url VARCHAR(1024),\\n\\n    -- Account Status\\n    is_active BOOLEAN NOT NULL DEFAULT TRUE,\\n    is_admin BOOLEAN NOT NULL DEFAULT FALSE,\\n\\n    -- Timestamps\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    last_login_at TIMESTAMP WITH TIME ZONE,\\n    deleted_at TIMESTAMP WITH TIME ZONE,\\n\\n    -- Storage Quotas\\n    storage_used BIGINT NOT NULL DEFAULT 0,\\n    storage_quota BIGINT NOT NULL DEFAULT 10737418240, -- 10 GB in bytes\\n\\n    -- Extensibility\\n    metadata JSONB NOT NULL DEFAULT '{}'::jsonb\\n);\\n\\n-- Indexes\\nCREATE INDEX idx_users_email ON users(email) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_users_created_at ON users(created_at);\\n\\n-- Trigger\\nCREATE TRIGGER users_updated_at BEFORE UPDATE ON users\\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\\n\\nCOMMENT ON TABLE users IS 'User accounts and authentication';\\nCOMMENT ON COLUMN users.storage_used IS 'Total bytes used by user media files';\\nCOMMENT ON COLUMN users.storage_quota IS 'Maximum bytes allowed (default 10GB)';\\n\\n-- ==============================================================================\\n-- TABLE: media\\n-- ==============================================================================\\n\\nCREATE TABLE media (\\n    -- Identity\\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\\n\\n    -- Ownership\\n    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,\\n\\n    -- Basic Info\\n    filename VARCHAR(255) NOT NULL,\\n    media_type VARCHAR(50) NOT NULL,\\n    mime_type VARCHAR(100) NOT NULL,\\n\\n    -- File Information\\n    size BIGINT NOT NULL,\\n    width INTEGER,\\n    height INTEGER,\\n    duration DOUBLE PRECISION,\\n\\n    -- Storage\\n    file_path VARCHAR(1024) NOT NULL,\\n    thumbnail_path VARCHAR(1024),\\n    hash VARCHAR(64) NOT NULL,\\n\\n    -- Dates and Location\\n    taken_at TIMESTAMP WITH TIME ZONE,\\n    latitude DOUBLE PRECISION,\\n    longitude DOUBLE PRECISION,\\n\\n    -- Source Tracking\\n    source_type VARCHAR(50),\\n    source_id VARCHAR(255),\\n\\n    -- Processing Status\\n    processing_status VARCHAR(50) NOT NULL DEFAULT 'pending',\\n    thumbnail_generated BOOLEAN NOT NULL DEFAULT FALSE,\\n    metadata_extracted BOOLEAN NOT NULL DEFAULT FALSE,\\n\\n    -- Timestamps\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    deleted_at TIMESTAMP WITH TIME ZONE,\\n\\n    -- Extensibility\\n    metadata JSONB NOT NULL DEFAULT '{}'::jsonb,\\n\\n    -- Constraints\\n    CONSTRAINT chk_media_type CHECK (media_type IN ('photo', 'video', 'document', 'other')),\\n    CONSTRAINT chk_processing_status CHECK (processing_status IN ('pending', 'processing', 'complete', 'failed')),\\n    CONSTRAINT chk_latitude CHECK (latitude IS NULL OR (latitude >= -90 AND latitude <= 90)),\\n    CONSTRAINT chk_longitude CHECK (longitude IS NULL OR (longitude >= -180 AND longitude <= 180)),\\n    CONSTRAINT chk_size CHECK (size > 0)\\n);\\n\\n-- Indexes\\nCREATE INDEX idx_media_user_id ON media(user_id) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_media_hash ON media(hash);\\nCREATE INDEX idx_media_taken_at ON media(taken_at) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_media_media_type ON media(media_type) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_media_source ON media(user_id, source_type, source_id) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_media_metadata ON media USING GIN(metadata);\\n\\n-- Trigger\\nCREATE TRIGGER media_updated_at BEFORE UPDATE ON media\\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\\n\\nCOMMENT ON TABLE media IS 'Photos, videos, and other media files';\\nCOMMENT ON COLUMN media.hash IS 'SHA-256 hash for deduplication';\\nCOMMENT ON COLUMN media.metadata IS 'EXIF data, tags, descriptions, integration-specific data';\\n\\n-- ==============================================================================\\n-- TABLE: albums\\n-- ==============================================================================\\n\\nCREATE TABLE albums (\\n    -- Identity\\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\\n\\n    -- Ownership\\n    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,\\n\\n    -- Basic Info\\n    name VARCHAR(200) NOT NULL,\\n    description TEXT,\\n\\n    -- Display\\n    cover_media_id UUID REFERENCES media(id) ON DELETE SET NULL,\\n    sort_order VARCHAR(50) NOT NULL DEFAULT 'date_desc',\\n\\n    -- Counts (denormalized)\\n    media_count INTEGER NOT NULL DEFAULT 0,\\n\\n    -- Privacy\\n    visibility VARCHAR(50) NOT NULL DEFAULT 'private',\\n\\n    -- Timestamps\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    deleted_at TIMESTAMP WITH TIME ZONE,\\n\\n    -- Source Tracking\\n    source_type VARCHAR(50),\\n    source_id VARCHAR(255),\\n\\n    -- Extensibility\\n    metadata JSONB NOT NULL DEFAULT '{}'::jsonb,\\n\\n    -- Constraints\\n    CONSTRAINT chk_sort_order CHECK (sort_order IN ('date_asc', 'date_desc', 'manual')),\\n    CONSTRAINT chk_visibility CHECK (visibility IN ('private', 'unlisted', 'public')),\\n    CONSTRAINT chk_media_count CHECK (media_count >= 0)\\n);\\n\\n-- Indexes\\nCREATE INDEX idx_albums_user_id ON albums(user_id) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_albums_name ON albums(user_id, name) WHERE deleted_at IS NULL;\\n\\n-- Trigger\\nCREATE TRIGGER albums_updated_at BEFORE UPDATE ON albums\\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\\n\\nCOMMENT ON TABLE albums IS 'Collections of media objects';\\nCOMMENT ON COLUMN albums.media_count IS 'Denormalized count of media in album (via links)';\\n\\n-- ==============================================================================\\n-- TABLE: integrations\\n-- ==============================================================================\\n\\nCREATE TABLE integrations (\\n    -- Identity\\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\\n\\n    -- Ownership\\n    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,\\n\\n    -- Integration Details\\n    integration_type VARCHAR(50) NOT NULL,\\n    integration_name VARCHAR(200) NOT NULL,\\n\\n    -- Status\\n    status VARCHAR(50) NOT NULL DEFAULT 'pending',\\n    is_enabled BOOLEAN NOT NULL DEFAULT TRUE,\\n\\n    -- OAuth2\\n    token_expires_at TIMESTAMP WITH TIME ZONE,\\n\\n    -- Sync State\\n    last_sync_at TIMESTAMP WITH TIME ZONE,\\n    last_sync_status VARCHAR(50),\\n    sync_cursor TEXT,\\n\\n    -- Statistics\\n    items_synced INTEGER NOT NULL DEFAULT 0,\\n\\n    -- Timestamps\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    deleted_at TIMESTAMP WITH TIME ZONE,\\n\\n    -- Source Tracking\\n    source_type VARCHAR(50),\\n    source_id VARCHAR(255),\\n\\n    -- Extensibility\\n    metadata JSONB NOT NULL DEFAULT '{}'::jsonb,\\n\\n    -- Constraints\\n    CONSTRAINT chk_integration_status CHECK (status IN ('connected', 'disconnected', 'error', 'pending')),\\n    CONSTRAINT chk_sync_status CHECK (last_sync_status IS NULL OR last_sync_status IN ('success', 'partial', 'failed')),\\n    CONSTRAINT chk_items_synced CHECK (items_synced >= 0)\\n);\\n\\n-- Indexes\\nCREATE INDEX idx_integrations_user_id ON integrations(user_id) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_integrations_type ON integrations(user_id, integration_type) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_integrations_status ON integrations(status) WHERE deleted_at IS NULL;\\n\\n-- Trigger\\nCREATE TRIGGER integrations_updated_at BEFORE UPDATE ON integrations\\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\\n\\nCOMMENT ON TABLE integrations IS 'Connected external services (Instagram, Google Photos, etc.)';\\nCOMMENT ON COLUMN integrations.sync_cursor IS 'Pagination cursor for incremental sync';\\n\\n-- ==============================================================================\\n-- TABLE: integration_secrets\\n-- ==============================================================================\\n\\nCREATE TABLE integration_secrets (\\n    -- Identity (one-to-one with integrations)\\n    integration_id UUID PRIMARY KEY REFERENCES integrations(id) ON DELETE CASCADE,\\n\\n    -- OAuth2 Tokens (consider encrypting these)\\n    access_token TEXT,\\n    refresh_token TEXT,\\n\\n    -- Timestamps\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()\\n);\\n\\n-- Trigger\\nCREATE TRIGGER integration_secrets_updated_at BEFORE UPDATE ON integration_secrets\\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\\n\\nCOMMENT ON TABLE integration_secrets IS 'OAuth tokens and secrets (encrypted at rest)';\\nCOMMENT ON COLUMN integration_secrets.access_token IS 'OAuth2 access token - should be encrypted';\\nCOMMENT ON COLUMN integration_secrets.refresh_token IS 'OAuth2 refresh token - should be encrypted';\\n\\n-- ==============================================================================\\n-- TABLE: links\\n-- ==============================================================================\\n\\nCREATE TABLE links (\\n    -- Identity\\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\\n\\n    -- Ownership\\n    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,\\n\\n    -- Link Endpoints\\n    from_object_id UUID NOT NULL,\\n    from_object_type VARCHAR(50) NOT NULL,\\n    to_object_id UUID NOT NULL,\\n    to_object_type VARCHAR(50) NOT NULL,\\n\\n    -- Link Type\\n    link_type VARCHAR(50) NOT NULL,\\n\\n    -- Link Properties\\n    strength DOUBLE PRECISION NOT NULL DEFAULT 1.0,\\n    is_bidirectional BOOLEAN NOT NULL DEFAULT FALSE,\\n\\n    -- Ordering\\n    sort_order INTEGER,\\n\\n    -- Timestamps\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    deleted_at TIMESTAMP WITH TIME ZONE,\\n\\n    -- Source Tracking\\n    source_type VARCHAR(50),\\n    source_id VARCHAR(255),\\n\\n    -- Extensibility\\n    metadata JSONB NOT NULL DEFAULT '{}'::jsonb,\\n\\n    -- Constraints\\n    CONSTRAINT chk_link_type CHECK (link_type IN ('contains', 'source', 'duplicate_of', 'variant_of', 'related_to')),\\n    CONSTRAINT chk_strength CHECK (strength >= 0.0 AND strength <= 1.0),\\n    CONSTRAINT chk_not_self_link CHECK (\\n        from_object_id != to_object_id OR from_object_type != to_object_type\\n    )\\n);\\n\\n-- Indexes\\nCREATE INDEX idx_links_user_id ON links(user_id) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_links_from ON links(from_object_id, link_type) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_links_to ON links(to_object_id, link_type) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_links_ordered ON links(from_object_id, sort_order)\\n    WHERE deleted_at IS NULL AND sort_order IS NOT NULL;\\n\\n-- Unique constraint: No duplicate links\\nCREATE UNIQUE INDEX idx_links_unique ON links(from_object_id, to_object_id, link_type)\\n    WHERE deleted_at IS NULL;\\n\\n-- Trigger\\nCREATE TRIGGER links_updated_at BEFORE UPDATE ON links\\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\\n\\nCOMMENT ON TABLE links IS 'Relationships between objects (first-class links)';\\nCOMMENT ON COLUMN links.strength IS 'Confidence/strength of relationship (0.0 to 1.0)';\\nCOMMENT ON COLUMN links.sort_order IS 'Position in ordered list (NULL if unordered)';\\n\\n-- ==============================================================================\\n-- TABLE: refresh_tokens (JWT refresh token management)\\n-- ==============================================================================\\n\\nCREATE TABLE refresh_tokens (\\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\\n    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,\\n    token_hash VARCHAR(64) NOT NULL UNIQUE,\\n    expires_at TIMESTAMP WITH TIME ZONE NOT NULL,\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    revoked_at TIMESTAMP WITH TIME ZONE\\n);\\n\\nCREATE INDEX idx_refresh_tokens_user_id ON refresh_tokens(user_id);\\nCREATE INDEX idx_refresh_tokens_hash ON refresh_tokens(token_hash) WHERE revoked_at IS NULL;\\nCREATE INDEX idx_refresh_tokens_expires ON refresh_tokens(expires_at) WHERE revoked_at IS NULL;\\n\\nCOMMENT ON TABLE refresh_tokens IS 'JWT refresh tokens for token rotation';\\nCOMMENT ON COLUMN refresh_tokens.token_hash IS 'SHA-256 hash of refresh token';\\n\\n-- ==============================================================================\\n-- TABLE: audit_log (security audit trail)\\n-- ==============================================================================\\n\\nCREATE TABLE audit_log (\\n    id BIGSERIAL PRIMARY KEY,\\n    user_id UUID REFERENCES users(id) ON DELETE SET NULL,\\n    action VARCHAR(100) NOT NULL,\\n    resource_type VARCHAR(50),\\n    resource_id UUID,\\n    ip_address INET,\\n    user_agent TEXT,\\n    details JSONB,\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()\\n);\\n\\nCREATE INDEX idx_audit_log_user_id ON audit_log(user_id);\\nCREATE INDEX idx_audit_log_created_at ON audit_log(created_at);\\nCREATE INDEX idx_audit_log_action ON audit_log(action);\\nCREATE INDEX idx_audit_log_resource ON audit_log(resource_type, resource_id);\\n\\nCOMMENT ON TABLE audit_log IS 'Security audit trail for all important actions';\\nCOMMENT ON COLUMN audit_log.action IS 'Action performed (login, upload, delete, etc.)';\\n\\n-- ==============================================================================\\n-- VIEWS: Convenience views for active (non-deleted) objects\\n-- ==============================================================================\\n\\nCREATE VIEW active_media AS\\nSELECT * FROM media WHERE deleted_at IS NULL;\\n\\nCREATE VIEW active_albums AS\\nSELECT * FROM albums WHERE deleted_at IS NULL;\\n\\nCREATE VIEW active_links AS\\nSELECT * FROM links WHERE deleted_at IS NULL;\\n\\nCREATE VIEW active_integrations AS\\nSELECT * FROM integrations WHERE deleted_at IS NULL;\\n\\nCOMMENT ON VIEW active_media IS 'Media objects that are not soft-deleted';\\nCOMMENT ON VIEW active_albums IS 'Albums that are not soft-deleted';\\nCOMMENT ON VIEW active_links IS 'Links that are not soft-deleted';\\nCOMMENT ON VIEW active_integrations IS 'Integrations that are not soft-deleted';\\n\\n-- ==============================================================================\\n-- INITIAL DATA (optional)\\n-- ==============================================================================\\n\\n-- Create a test admin user (password: ChangeMe123!)\\n-- Password hash for \\\"ChangeMe123!\\\" using bcrypt\\nINSERT INTO users (email, password_hash, display_name, is_admin, email_verified)\\nVALUES (\\n    'admin@hypernet.local',\\n    '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5GyYqXdz4.9Gu',\\n    'Admin User',\\n    TRUE,\\n    TRUE\\n);\\n\\n-- ==============================================================================\\n-- DONE\\n-- ==============================================================================\\n\\n-- Verify tables created\\nSELECT table_name FROM information_schema.tables\\nWHERE table_schema = 'public' AND table_type = 'BASE TABLE'\\nORDER BY table_name;\\n\\nCOMMENT ON DATABASE hypernet IS 'Hypernet Core 0.1 - Universal VR Platform Database';\\n\"\n  },\n  \"created_at\": \"2026-02-15T11:53:48.229565+00:00\",\n  \"updated_at\": \"2026-02-15T11:53:48.229565+00:00\",\n  \"deleted_at\": null,\n  \"source_type\": \"import\",\n  \"source_id\": \"file:02-Initial-Migration.sql\"\n}"
  },
  "created_at": "2026-02-15T11:53:53.198423+00:00",
  "updated_at": "2026-02-15T11:53:53.198423+00:00",
  "deleted_at": null,
  "source_type": "import",
  "source_id": "file:node.json"
}