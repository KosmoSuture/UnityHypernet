{
  "address": "0.1.11.1.0.1.0.5.1.1",
  "type_address": null,
  "data": {
    "name": "v0001.json",
    "type": "file",
    "extension": ".json",
    "path": "C:\\Hypernet\\Hypernet Structure\\0\\0.1 - Hypernet Core\\data\\history\\0\\1\\0\\5\\1\\v0001.json",
    "size": 30752,
    "content": "{\n  \"version\": 1,\n  \"content_hash\": \"e861e522ac9484c1\",\n  \"snapshot_at\": \"2026-02-17T01:21:58.239477+00:00\",\n  \"node\": {\n    \"address\": \"0.1.0.5.1\",\n    \"type_address\": null,\n    \"data\": {\n      \"name\": \"01-Object-Model-Specification.md\",\n      \"type\": \"file\",\n      \"extension\": \".md\",\n      \"path\": \"C:\\\\Hypernet\\\\Hypernet Structure\\\\0\\\\0.1 - Hypernet Core\\\\0.1.0 - Planning & Documentation\\\\API-Design\\\\01-Object-Model-Specification.md\",\n      \"size\": 29023,\n      \"content\": \"# Hypernet Core - Object Model Specification\\n\\n**Version:** 0.1.0\\n**Last Updated:** 2026-02-03\\n**Status:** Design Phase\\n**Related:** Database-Design/, API endpoint specifications\\n\\n---\\n\\n## Table of Contents\\n\\n1. [Overview](#overview)\\n2. [Design Philosophy](#design-philosophy)\\n3. [Core Object Types](#core-object-types)\\n4. [Object Schema](#object-schema)\\n5. [Field Types and Validation](#field-types-and-validation)\\n6. [Metadata and Extensibility](#metadata-and-extensibility)\\n7. [Object Lifecycle](#object-lifecycle)\\n8. [Object Relationships](#object-relationships)\\n9. [Examples](#examples)\\n\\n---\\n\\n## Overview\\n\\nThe Hypernet object model defines how all data is structured, stored, and accessed through the API. It uses a **hybrid approach** combining:\\n\\n- **Structured core fields** (predictable, queryable, performant)\\n- **Flexible metadata** (integration-specific, extensible)\\n- **First-class links** (relationships as objects, see Link Model spec)\\n\\nThis design balances:\\n- \\u2705 **Performance** - Core fields indexed and optimized\\n- \\u2705 **Flexibility** - New integrations don't require schema changes\\n- \\u2705 **Queryability** - Can filter/search by common attributes\\n- \\u2705 **Type Safety** - Strong typing in API and database\\n\\n---\\n\\n## Design Philosophy\\n\\n### Principles\\n\\n1. **Hybrid Schema**\\n   - Core fields are strongly typed and validated\\n   - Integration-specific data stored in `metadata` JSON field\\n   - Balance structure and flexibility\\n\\n2. **Immutable IDs**\\n   - Every object has a unique, immutable UUID\\n   - UUIDs are globally unique (can merge databases later)\\n   - Never reused, even after deletion\\n\\n3. **Ownership and Isolation**\\n   - Every object (except User) belongs to a single user\\n   - Users can only access their own objects (enforced at API + DB level)\\n   - Multi-tenancy via `user_id` foreign key\\n\\n4. **Audit Trail**\\n   - All objects have `created_at`, `updated_at` timestamps\\n   - Deletions are soft by default (marked `deleted_at`, not removed)\\n   - Can reconstruct history of changes\\n\\n5. **Source Tracking**\\n   - Objects created via integrations track their source\\n   - `source_type` and `source_id` fields link back to original\\n   - Enables sync, deduplication, and provenance\\n\\n6. **Extensibility**\\n   - New object types can be added without breaking existing code\\n   - `metadata` field allows arbitrary additional data\\n   - Plugin architecture for type-specific behavior\\n\\n---\\n\\n## Core Object Types\\n\\n### Phase 1 Object Types\\n\\nThese are the minimum object types for Phase 1 (0.1.0):\\n\\n| Object Type | Purpose | Examples |\\n|-------------|---------|----------|\\n| **User** | Account, authentication, ownership | user@example.com |\\n| **Media** | Photos, videos, files | IMG_1234.jpg, video.mp4 |\\n| **Album** | Collections of media | \\\"Vacation 2025\\\", \\\"Family Photos\\\" |\\n| **Integration** | Connected external services | Instagram account, Google Photos |\\n| **Link** | Relationships between objects | Photo \\u2192 Instagram Post, Photo \\u2192 Album |\\n\\n### Phase 2+ Object Types (Future)\\n\\nNot implemented in Phase 1, but design should accommodate:\\n\\n| Object Type | Purpose | Examples |\\n|-------------|---------|----------|\\n| **Post** | Social media posts | Tweet, Facebook post, Instagram story |\\n| **Message** | Communications | Email, SMS, chat message |\\n| **Contact** | People | Friends, family, colleagues |\\n| **Event** | Calendar events | Birthday, meeting, vacation |\\n| **Location** | Places | GPS coordinates, addresses |\\n| **Tag** | User-defined labels | #vacation, #family, #work |\\n\\n---\\n\\n## Object Schema\\n\\n### Base Object\\n\\nAll objects inherit these common fields:\\n\\n```python\\nclass BaseObject:\\n    \\\"\\\"\\\"Base class for all Hypernet objects\\\"\\\"\\\"\\n\\n    # Identity\\n    id: UUID                    # Unique identifier (UUIDv4)\\n    type: str                   # Object type (\\\"media\\\", \\\"album\\\", etc.)\\n\\n    # Ownership\\n    user_id: UUID               # Owner (foreign key to User)\\n\\n    # Timestamps\\n    created_at: datetime        # When created (UTC, ISO 8601)\\n    updated_at: datetime        # Last modified (UTC, ISO 8601)\\n    deleted_at: datetime | None # Soft delete timestamp (null if not deleted)\\n\\n    # Source Tracking\\n    source_type: str | None     # Where it came from (\\\"integration\\\", \\\"upload\\\", \\\"system\\\")\\n    source_id: str | None       # ID in source system (e.g., Instagram post ID)\\n\\n    # Extensibility\\n    metadata: dict              # JSON object for additional fields\\n```\\n\\n### User Object\\n\\n```python\\nclass User(BaseObject):\\n    \\\"\\\"\\\"User account and authentication\\\"\\\"\\\"\\n\\n    type: str = \\\"user\\\"          # Always \\\"user\\\"\\n\\n    # Authentication\\n    email: str                  # Email address (unique, indexed)\\n    password_hash: str          # bcrypt or argon2 hash\\n    email_verified: bool        # Email verification status\\n\\n    # Profile\\n    display_name: str | None    # Display name (optional)\\n    avatar_url: str | None      # Profile picture URL (optional)\\n\\n    # Account Status\\n    is_active: bool             # Account enabled/disabled\\n    is_admin: bool              # Admin privileges\\n\\n    # Timestamps (inherited from BaseObject)\\n    created_at: datetime        # Account creation\\n    updated_at: datetime        # Last profile update\\n    last_login_at: datetime     # Last successful login\\n\\n    # Quotas and Limits\\n    storage_used: int           # Bytes used (for photos/videos)\\n    storage_quota: int          # Bytes allowed (default: 10 GB)\\n\\n    # Metadata\\n    metadata: dict              # User preferences, settings, etc.\\n```\\n\\n**Validation:**\\n- `email`: Valid email format, unique across all users\\n- `password`: Min 12 chars, complexity requirements (enforced at API level)\\n- `display_name`: Max 100 chars, no special characters\\n- `storage_quota`: Min 1GB, max 1TB (configurable)\\n\\n**Indexes:**\\n- Primary key: `id`\\n- Unique: `email`\\n- Index: `created_at` (for user stats)\\n\\n---\\n\\n### Media Object\\n\\n```python\\nclass Media(BaseObject):\\n    \\\"\\\"\\\"Photos, videos, and other media files\\\"\\\"\\\"\\n\\n    type: str = \\\"media\\\"         # Always \\\"media\\\"\\n\\n    # Basic Info\\n    filename: str               # Original filename\\n    media_type: str             # \\\"photo\\\", \\\"video\\\", \\\"document\\\", \\\"other\\\"\\n    mime_type: str              # MIME type (image/jpeg, video/mp4, etc.)\\n\\n    # File Information\\n    size: int                   # File size in bytes\\n    width: int | None           # Image/video width in pixels\\n    height: int | None          # Image/video height in pixels\\n    duration: float | None      # Video duration in seconds\\n\\n    # Storage\\n    file_path: str              # Path in /media partition (relative)\\n    thumbnail_path: str | None  # Path to thumbnail (if generated)\\n    hash: str                   # SHA-256 hash of file (for deduplication)\\n\\n    # Dates and Location\\n    taken_at: datetime | None   # When photo/video was taken (from EXIF)\\n    latitude: float | None      # GPS latitude (from EXIF)\\n    longitude: float | None     # GPS longitude (from EXIF)\\n\\n    # Source Tracking (inherited, but commonly used)\\n    source_type: str | None     # \\\"upload\\\", \\\"integration\\\", \\\"import\\\"\\n    source_id: str | None       # External ID (e.g., Instagram media ID)\\n\\n    # Processing Status\\n    processing_status: str      # \\\"pending\\\", \\\"processing\\\", \\\"complete\\\", \\\"failed\\\"\\n    thumbnail_generated: bool   # Has thumbnail been created?\\n    metadata_extracted: bool    # Has EXIF/metadata been extracted?\\n\\n    # Metadata (EXIF and more)\\n    metadata: dict              # {\\n                                #   \\\"exif\\\": {...},          # EXIF data\\n                                #   \\\"camera\\\": \\\"iPhone 15\\\",  # Camera model\\n                                #   \\\"tags\\\": [\\\"vacation\\\"],   # User tags\\n                                #   \\\"description\\\": \\\"...\\\",   # User description\\n                                #   \\\"integration_data\\\": {...} # Integration-specific\\n                                # }\\n```\\n\\n**Validation:**\\n- `filename`: Max 255 chars, valid filename chars\\n- `media_type`: One of [\\\"photo\\\", \\\"video\\\", \\\"document\\\", \\\"other\\\"]\\n- `mime_type`: Valid MIME type from allowed list\\n- `size`: Max 100MB for photos, 1GB for videos (configurable)\\n- `hash`: Valid SHA-256 hash (64 hex chars)\\n- `latitude`: -90 to 90\\n- `longitude`: -180 to 180\\n- `processing_status`: One of [\\\"pending\\\", \\\"processing\\\", \\\"complete\\\", \\\"failed\\\"]\\n\\n**Indexes:**\\n- Primary key: `id`\\n- Foreign key: `user_id` (with index)\\n- Index: `hash` (for deduplication)\\n- Index: `taken_at` (for timeline queries)\\n- Index: `media_type` (for filtering)\\n- Composite: `(user_id, source_type, source_id)` (for sync deduplication)\\n\\n**File Path Convention:**\\n```\\n/media/users/{user_id}/media/{year}/{month}/{id}.{ext}\\nExample: /media/users/a1b2c3d4-1234-5678-abcd-123456789abc/media/2026/02/e5f6g7h8-5678-90ab-cdef-567890abcdef.jpg\\n```\\n\\n---\\n\\n### Album Object\\n\\n```python\\nclass Album(BaseObject):\\n    \\\"\\\"\\\"Collection of media objects\\\"\\\"\\\"\\n\\n    type: str = \\\"album\\\"         # Always \\\"album\\\"\\n\\n    # Basic Info\\n    name: str                   # Album name\\n    description: str | None     # Album description (optional)\\n\\n    # Display\\n    cover_media_id: UUID | None # Media object to use as cover (foreign key)\\n    sort_order: str             # \\\"date_asc\\\", \\\"date_desc\\\", \\\"manual\\\"\\n\\n    # Counts (denormalized for performance)\\n    media_count: int            # Number of media in album (cached)\\n\\n    # Privacy (Phase 2)\\n    visibility: str             # \\\"private\\\", \\\"unlisted\\\", \\\"public\\\" (future)\\n\\n    # Metadata\\n    metadata: dict              # {\\n                                #   \\\"color\\\": \\\"#ff5733\\\",    # Theme color\\n                                #   \\\"icon\\\": \\\"camera\\\",      # Icon name\\n                                #   \\\"tags\\\": [...],         # Tags\\n                                # }\\n```\\n\\n**Validation:**\\n- `name`: Max 200 chars, required\\n- `description`: Max 5000 chars\\n- `sort_order`: One of [\\\"date_asc\\\", \\\"date_desc\\\", \\\"manual\\\"]\\n- `visibility`: One of [\\\"private\\\", \\\"unlisted\\\", \\\"public\\\"]\\n- `media_count`: >= 0\\n\\n**Indexes:**\\n- Primary key: `id`\\n- Foreign key: `user_id` (with index)\\n- Foreign key: `cover_media_id` (nullable)\\n- Index: `name` (for search)\\n\\n**Notes:**\\n- Media \\u2194 Album relationship handled via Link objects (many-to-many)\\n- A media object can be in multiple albums\\n- An album can contain many media objects\\n\\n---\\n\\n### Integration Object\\n\\n```python\\nclass Integration(BaseObject):\\n    \\\"\\\"\\\"Connected external service (Instagram, Google Photos, etc.)\\\"\\\"\\\"\\n\\n    type: str = \\\"integration\\\"   # Always \\\"integration\\\"\\n\\n    # Integration Details\\n    integration_type: str       # \\\"instagram\\\", \\\"google_photos\\\", \\\"facebook\\\", etc.\\n    integration_name: str       # Display name (e.g., \\\"@username\\\")\\n\\n    # Status\\n    status: str                 # \\\"connected\\\", \\\"disconnected\\\", \\\"error\\\", \\\"pending\\\"\\n    is_enabled: bool            # User can disable without disconnecting\\n\\n    # OAuth2 (for integrations requiring OAuth)\\n    access_token: str | None    # OAuth access token (encrypted)\\n    refresh_token: str | None   # OAuth refresh token (encrypted)\\n    token_expires_at: datetime | None  # Token expiration\\n\\n    # Sync State\\n    last_sync_at: datetime | None      # Last successful sync\\n    last_sync_status: str              # \\\"success\\\", \\\"partial\\\", \\\"failed\\\"\\n    sync_cursor: str | None            # Cursor/offset for incremental sync\\n\\n    # Statistics\\n    items_synced: int           # Total items imported from this integration\\n\\n    # Metadata\\n    metadata: dict              # {\\n                                #   \\\"user_id\\\": \\\"...\\\",        # External user ID\\n                                #   \\\"username\\\": \\\"@john\\\",     # External username\\n                                #   \\\"profile_url\\\": \\\"...\\\",    # External profile\\n                                #   \\\"sync_settings\\\": {...},  # What to sync\\n                                #   \\\"rate_limit\\\": {...},     # API rate limit info\\n                                # }\\n```\\n\\n**Validation:**\\n- `integration_type`: One of allowed integration types\\n- `integration_name`: Max 200 chars\\n- `status`: One of [\\\"connected\\\", \\\"disconnected\\\", \\\"error\\\", \\\"pending\\\"]\\n- `last_sync_status`: One of [\\\"success\\\", \\\"partial\\\", \\\"failed\\\"]\\n- `items_synced`: >= 0\\n\\n**Indexes:**\\n- Primary key: `id`\\n- Foreign key: `user_id` (with index)\\n- Composite: `(user_id, integration_type)` (user can have multiple of same type)\\n- Index: `status` (for monitoring)\\n\\n**Security:**\\n- `access_token` and `refresh_token` encrypted at rest (database-level encryption)\\n- Never returned in API responses (use `[REDACTED]` placeholder)\\n- Stored in encrypted secrets table (separate from main Integration table)\\n\\n---\\n\\n### Link Object\\n\\n```python\\nclass Link(BaseObject):\\n    \\\"\\\"\\\"Relationship between two objects\\\"\\\"\\\"\\n\\n    type: str = \\\"link\\\"          # Always \\\"link\\\"\\n\\n    # Link Endpoints\\n    from_object_id: UUID        # Source object ID (foreign key)\\n    from_object_type: str       # Source object type (\\\"media\\\", \\\"album\\\", etc.)\\n    to_object_id: UUID          # Target object ID (foreign key)\\n    to_object_type: str         # Target object type\\n\\n    # Link Type\\n    link_type: str              # Relationship type (see below)\\n\\n    # Link Properties\\n    strength: float             # Confidence/strength (0.0 to 1.0)\\n    is_bidirectional: bool      # Does link go both ways?\\n\\n    # Ordering (for ordered relationships like album \\u2192 photos)\\n    sort_order: int | None      # Position in ordered list (null if unordered)\\n\\n    # Metadata\\n    metadata: dict              # {\\n                                #   \\\"created_by\\\": \\\"system\\\" | \\\"user\\\",\\n                                #   \\\"reason\\\": \\\"...\\\",\\n                                #   \\\"properties\\\": {...}\\n                                # }\\n```\\n\\n**Link Types:**\\n\\n| Link Type | From \\u2192 To | Description | Example |\\n|-----------|-----------|-------------|---------|\\n| `contains` | Album \\u2192 Media | Album contains media | \\\"Vacation\\\" album contains photo123 |\\n| `source` | Media \\u2192 Integration | Media came from integration | photo456 sourced from Instagram |\\n| `duplicate_of` | Media \\u2192 Media | Duplicate detection | photo789 is duplicate of photo123 |\\n| `variant_of` | Media \\u2192 Media | Different version | thumbnail is variant of original |\\n| `related_to` | Any \\u2192 Any | Generic relationship | (future use) |\\n| `tagged_with` | Media \\u2192 Tag | Media has tag | (Phase 2) |\\n| `depicts` | Media \\u2192 Contact | Media shows person | (Phase 2) |\\n| `taken_at` | Media \\u2192 Location | Media taken at location | (Phase 2) |\\n\\n**Validation:**\\n- `from_object_id`, `to_object_id`: Valid UUIDs, objects must exist\\n- `from_object_type`, `to_object_type`: Valid object types\\n- `link_type`: One of allowed link types\\n- `strength`: 0.0 to 1.0\\n- `sort_order`: >= 0\\n\\n**Indexes:**\\n- Primary key: `id`\\n- Foreign key: `user_id` (with index)\\n- Composite: `(from_object_id, link_type)` (fast \\\"get all links from object\\\")\\n- Composite: `(to_object_id, link_type)` (fast \\\"get all links to object\\\")\\n- Composite: `(from_object_id, to_object_id, link_type)` (prevent duplicate links)\\n\\n**Constraints:**\\n- Unique constraint on `(from_object_id, to_object_id, link_type)` - no duplicate links\\n- Objects can't link to themselves (checked at API level)\\n- `from_object` and `to_object` must belong to same user (enforced at API + DB)\\n\\n**See:** `02-Link-Model-Specification.md` for detailed link semantics\\n\\n---\\n\\n## Field Types and Validation\\n\\n### Data Types\\n\\n| Type | Python Type | PostgreSQL Type | Validation |\\n|------|-------------|-----------------|------------|\\n| **UUID** | `uuid.UUID` | `UUID` | UUIDv4 format |\\n| **String** | `str` | `VARCHAR(n)` or `TEXT` | Max length, allowed chars |\\n| **Integer** | `int` | `INTEGER` or `BIGINT` | Range checks |\\n| **Float** | `float` | `DOUBLE PRECISION` | Range checks |\\n| **Boolean** | `bool` | `BOOLEAN` | True/False only |\\n| **Datetime** | `datetime` | `TIMESTAMP WITH TIME ZONE` | ISO 8601, UTC |\\n| **JSON** | `dict` | `JSONB` | Valid JSON, schema validation |\\n| **Enum** | `str` | `VARCHAR` or `ENUM` | One of allowed values |\\n\\n### String Validation\\n\\n```python\\n# Email\\npattern: r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\\\.[a-zA-Z]{2,}$'\\nmax_length: 255\\n\\n# Filename\\npattern: r'^[a-zA-Z0-9._-]+$'  # No path separators, special chars\\nmax_length: 255\\n\\n# Display Name\\npattern: r'^[a-zA-Z0-9 ._-]+$'  # Alphanumeric + space and common punctuation\\nmax_length: 100\\n\\n# File Path\\npattern: r'^[a-zA-Z0-9/._-]+$'  # Unix-style paths\\nmax_length: 1024\\n\\n# SHA-256 Hash\\npattern: r'^[a-f0-9]{64}$'      # 64 hex characters\\nlength: 64\\n```\\n\\n### Datetime Handling\\n\\n- **Storage:** Always UTC, stored as `TIMESTAMP WITH TIME ZONE`\\n- **API:** ISO 8601 format (`2026-02-03T12:34:56.789Z`)\\n- **Timezone:** Server converts to UTC, clients handle local display\\n- **Precision:** Milliseconds (3 decimal places)\\n\\n### JSON Metadata\\n\\n- **Storage:** PostgreSQL `JSONB` (binary, indexed, queryable)\\n- **Validation:** Must be valid JSON object `{}`\\n- **Max Size:** 1MB per metadata field (configurable)\\n- **Indexing:** Can create GIN indexes on specific keys\\n\\n**Example:**\\n```json\\n{\\n  \\\"exif\\\": {\\n    \\\"camera\\\": \\\"Canon EOS R5\\\",\\n    \\\"lens\\\": \\\"RF 24-70mm f/2.8\\\",\\n    \\\"iso\\\": 400,\\n    \\\"aperture\\\": \\\"f/2.8\\\",\\n    \\\"shutter_speed\\\": \\\"1/250\\\",\\n    \\\"focal_length\\\": \\\"50mm\\\"\\n  },\\n  \\\"tags\\\": [\\\"vacation\\\", \\\"beach\\\", \\\"sunset\\\"],\\n  \\\"description\\\": \\\"Beautiful sunset at the beach\\\",\\n  \\\"location_name\\\": \\\"Santa Monica Beach\\\",\\n  \\\"instagram\\\": {\\n    \\\"post_id\\\": \\\"ABC123XYZ\\\",\\n    \\\"likes\\\": 42,\\n    \\\"comments\\\": 5,\\n    \\\"caption\\\": \\\"Amazing sunset! \\ud83c\\udf05\\\"\\n  }\\n}\\n```\\n\\n---\\n\\n## Metadata and Extensibility\\n\\n### Core vs. Metadata\\n\\n**Core Fields:**\\n- Defined in object schema\\n- Strongly typed and validated\\n- Indexed for performance\\n- Common across all instances of object type\\n- **Examples:** `id`, `user_id`, `created_at`, `filename`, `size`\\n\\n**Metadata Fields:**\\n- Stored in `metadata` JSON column\\n- Flexible structure\\n- Integration-specific or optional\\n- Can be indexed selectively (JSONB GIN indexes)\\n- **Examples:** EXIF data, external IDs, user-defined tags, custom properties\\n\\n### When to Use Core vs. Metadata\\n\\n**Use Core Field When:**\\n- Field is required for all instances\\n- Field needs to be indexed for performance\\n- Field is used in frequent queries or filters\\n- Field has strict validation requirements\\n\\n**Use Metadata When:**\\n- Field is optional or integration-specific\\n- Field structure varies by source\\n- Field is rarely queried\\n- Field is user-defined or extensible\\n\\n### Metadata Schema Evolution\\n\\nMetadata is **schema-less** but **conventionally structured**:\\n\\n```python\\n# Convention for metadata structure\\nmetadata = {\\n    # EXIF data (for photos/videos)\\n    \\\"exif\\\": {\\n        \\\"camera\\\": str,\\n        \\\"lens\\\": str,\\n        \\\"iso\\\": int,\\n        \\\"aperture\\\": str,\\n        \\\"shutter_speed\\\": str,\\n        # ... more EXIF fields\\n    },\\n\\n    # User-defined tags\\n    \\\"tags\\\": [str, str, ...],\\n\\n    # User description\\n    \\\"description\\\": str,\\n\\n    # Integration-specific data (namespaced by integration type)\\n    \\\"instagram\\\": {\\n        \\\"post_id\\\": str,\\n        \\\"permalink\\\": str,\\n        \\\"likes\\\": int,\\n        \\\"comments\\\": int,\\n        \\\"caption\\\": str,\\n        \\\"hashtags\\\": [str, ...]\\n    },\\n\\n    \\\"google_photos\\\": {\\n        \\\"media_item_id\\\": str,\\n        \\\"product_url\\\": str,\\n        \\\"base_url\\\": str,\\n        \\\"album_id\\\": str\\n    },\\n\\n    # Any other custom fields\\n    \\\"custom\\\": {\\n        # User or plugin-defined fields\\n    }\\n}\\n```\\n\\n**Validation:**\\n- Metadata must be valid JSON\\n- Max size: 1MB (configurable)\\n- No PII in metadata unless explicitly user-provided\\n- Scrub sensitive data from integration metadata\\n\\n---\\n\\n## Object Lifecycle\\n\\n### Creation\\n\\n```\\n1. API receives object creation request\\n2. Validate request payload (Pydantic model)\\n3. Generate UUID for object ID\\n4. Set user_id from authenticated user\\n5. Set created_at, updated_at to current time\\n6. Initialize metadata to {}\\n7. Insert into database\\n8. Return created object in response\\n```\\n\\n### Read\\n\\n```\\n1. API receives object read request (by ID)\\n2. Authenticate user\\n3. Query database for object by ID\\n4. Verify object.user_id == authenticated user\\n5. Return object in response (or 404/403)\\n```\\n\\n### Update\\n\\n```\\n1. API receives object update request (by ID)\\n2. Authenticate user\\n3. Load existing object from database\\n4. Verify object.user_id == authenticated user\\n5. Validate update payload\\n6. Merge changes (preserve immutable fields)\\n7. Set updated_at to current time\\n8. Update in database\\n9. Return updated object in response\\n```\\n\\n### Delete\\n\\n**Soft Delete (Default):**\\n```\\n1. API receives delete request (by ID)\\n2. Authenticate user\\n3. Load object from database\\n4. Verify object.user_id == authenticated user\\n5. Set deleted_at to current time\\n6. Update in database\\n7. Return 204 No Content\\n```\\n\\n**Hard Delete (Admin Only, Permanent):**\\n```\\n1. Verify user is admin\\n2. Delete associated files (media files, thumbnails)\\n3. Delete associated links (cascade)\\n4. Delete object from database (permanent)\\n5. Return 204 No Content\\n```\\n\\n**Soft-Deleted Objects:**\\n- Not returned in normal queries (WHERE deleted_at IS NULL)\\n- Can be restored by admin (set deleted_at = NULL)\\n- Permanently deleted after retention period (e.g., 30 days)\\n\\n---\\n\\n## Object Relationships\\n\\n### Ownership\\n\\n```\\nUser\\n  \\u2514\\u2500\\u2500 owns many \\u2192 Media\\n  \\u2514\\u2500\\u2500 owns many \\u2192 Album\\n  \\u2514\\u2500\\u2500 owns many \\u2192 Integration\\n  \\u2514\\u2500\\u2500 owns many \\u2192 Link\\n```\\n\\n**Enforcement:**\\n- All non-User objects have `user_id` foreign key\\n- API enforces: user can only access their own objects\\n- Database enforces: `ON DELETE CASCADE` for user deletion\\n\\n### Media Relationships\\n\\n```\\nMedia\\n  \\u251c\\u2500\\u2500 belongs to \\u2192 User (via user_id)\\n  \\u251c\\u2500\\u2500 in many \\u2192 Album (via Link: Album \\u2192 Media)\\n  \\u251c\\u2500\\u2500 sourced from \\u2192 Integration (via Link: Media \\u2192 Integration)\\n  \\u251c\\u2500\\u2500 has variants \\u2192 Media (via Link: Media \\u2192 Media, type \\\"variant_of\\\")\\n  \\u2514\\u2500\\u2500 has metadata \\u2192 JSONB (inline)\\n```\\n\\n### Album Relationships\\n\\n```\\nAlbum\\n  \\u251c\\u2500\\u2500 belongs to \\u2192 User (via user_id)\\n  \\u251c\\u2500\\u2500 contains many \\u2192 Media (via Link: Album \\u2192 Media)\\n  \\u2514\\u2500\\u2500 has cover \\u2192 Media (via cover_media_id foreign key)\\n```\\n\\n### Integration Relationships\\n\\n```\\nIntegration\\n  \\u251c\\u2500\\u2500 belongs to \\u2192 User (via user_id)\\n  \\u2514\\u2500\\u2500 sourced many \\u2192 Media (via Link: Media \\u2192 Integration)\\n```\\n\\n---\\n\\n## Examples\\n\\n### Example 1: Upload a Photo\\n\\n**Request:**\\n```http\\nPOST /api/v1/media/upload\\nAuthorization: Bearer {jwt_token}\\nContent-Type: multipart/form-data\\n\\n{file: photo.jpg}\\n```\\n\\n**Created Object:**\\n```json\\n{\\n  \\\"id\\\": \\\"a1b2c3d4-1234-5678-abcd-123456789abc\\\",\\n  \\\"type\\\": \\\"media\\\",\\n  \\\"user_id\\\": \\\"e5f6g7h8-5678-90ab-cdef-567890abcdef\\\",\\n  \\\"created_at\\\": \\\"2026-02-03T12:34:56.789Z\\\",\\n  \\\"updated_at\\\": \\\"2026-02-03T12:34:56.789Z\\\",\\n  \\\"deleted_at\\\": null,\\n  \\\"source_type\\\": \\\"upload\\\",\\n  \\\"source_id\\\": null,\\n  \\\"filename\\\": \\\"photo.jpg\\\",\\n  \\\"media_type\\\": \\\"photo\\\",\\n  \\\"mime_type\\\": \\\"image/jpeg\\\",\\n  \\\"size\\\": 2457600,\\n  \\\"width\\\": 4032,\\n  \\\"height\\\": 3024,\\n  \\\"duration\\\": null,\\n  \\\"file_path\\\": \\\"users/e5f6g7h8.../media/2026/02/a1b2c3d4....jpg\\\",\\n  \\\"thumbnail_path\\\": \\\"users/e5f6g7h8.../thumbnails/a1b2c3d4....jpg\\\",\\n  \\\"hash\\\": \\\"9f86d081884c7d659a2feaa0c55ad015a3bf4f1b2b0b822cd15d6c15b0f00a08\\\",\\n  \\\"taken_at\\\": \\\"2026-02-01T14:23:45.000Z\\\",\\n  \\\"latitude\\\": 34.0195,\\n  \\\"longitude\\\": -118.4912,\\n  \\\"processing_status\\\": \\\"complete\\\",\\n  \\\"thumbnail_generated\\\": true,\\n  \\\"metadata_extracted\\\": true,\\n  \\\"metadata\\\": {\\n    \\\"exif\\\": {\\n      \\\"camera\\\": \\\"iPhone 15 Pro\\\",\\n      \\\"lens\\\": \\\"iPhone 15 Pro back triple camera 6.86mm f/1.78\\\",\\n      \\\"iso\\\": 64,\\n      \\\"aperture\\\": \\\"f/1.78\\\",\\n      \\\"shutter_speed\\\": \\\"1/2000\\\"\\n    },\\n    \\\"tags\\\": [],\\n    \\\"description\\\": null\\n  }\\n}\\n```\\n\\n### Example 2: Create an Album\\n\\n**Request:**\\n```http\\nPOST /api/v1/albums\\nAuthorization: Bearer {jwt_token}\\nContent-Type: application/json\\n\\n{\\n  \\\"name\\\": \\\"Vacation 2026\\\",\\n  \\\"description\\\": \\\"Photos from our trip to California\\\"\\n}\\n```\\n\\n**Created Object:**\\n```json\\n{\\n  \\\"id\\\": \\\"b2c3d4e5-2345-6789-bcde-234567890bcd\\\",\\n  \\\"type\\\": \\\"album\\\",\\n  \\\"user_id\\\": \\\"e5f6g7h8-5678-90ab-cdef-567890abcdef\\\",\\n  \\\"created_at\\\": \\\"2026-02-03T12:40:00.123Z\\\",\\n  \\\"updated_at\\\": \\\"2026-02-03T12:40:00.123Z\\\",\\n  \\\"deleted_at\\\": null,\\n  \\\"source_type\\\": \\\"user\\\",\\n  \\\"source_id\\\": null,\\n  \\\"name\\\": \\\"Vacation 2026\\\",\\n  \\\"description\\\": \\\"Photos from our trip to California\\\",\\n  \\\"cover_media_id\\\": null,\\n  \\\"sort_order\\\": \\\"date_desc\\\",\\n  \\\"media_count\\\": 0,\\n  \\\"visibility\\\": \\\"private\\\",\\n  \\\"metadata\\\": {}\\n}\\n```\\n\\n### Example 3: Add Photo to Album (via Link)\\n\\n**Request:**\\n```http\\nPOST /api/v1/links\\nAuthorization: Bearer {jwt_token}\\nContent-Type: application/json\\n\\n{\\n  \\\"from_object_id\\\": \\\"b2c3d4e5-2345-6789-bcde-234567890bcd\\\",\\n  \\\"from_object_type\\\": \\\"album\\\",\\n  \\\"to_object_id\\\": \\\"a1b2c3d4-1234-5678-abcd-123456789abc\\\",\\n  \\\"to_object_type\\\": \\\"media\\\",\\n  \\\"link_type\\\": \\\"contains\\\",\\n  \\\"sort_order\\\": 0\\n}\\n```\\n\\n**Created Link:**\\n```json\\n{\\n  \\\"id\\\": \\\"c3d4e5f6-3456-7890-cdef-345678901cde\\\",\\n  \\\"type\\\": \\\"link\\\",\\n  \\\"user_id\\\": \\\"e5f6g7h8-5678-90ab-cdef-567890abcdef\\\",\\n  \\\"created_at\\\": \\\"2026-02-03T12:45:00.456Z\\\",\\n  \\\"updated_at\\\": \\\"2026-02-03T12:45:00.456Z\\\",\\n  \\\"deleted_at\\\": null,\\n  \\\"from_object_id\\\": \\\"b2c3d4e5-2345-6789-bcde-234567890bcd\\\",\\n  \\\"from_object_type\\\": \\\"album\\\",\\n  \\\"to_object_id\\\": \\\"a1b2c3d4-1234-5678-abcd-123456789abc\\\",\\n  \\\"to_object_type\\\": \\\"media\\\",\\n  \\\"link_type\\\": \\\"contains\\\",\\n  \\\"strength\\\": 1.0,\\n  \\\"is_bidirectional\\\": false,\\n  \\\"sort_order\\\": 0,\\n  \\\"metadata\\\": {\\n    \\\"created_by\\\": \\\"user\\\"\\n  }\\n}\\n```\\n\\n### Example 4: Integration Sync (Instagram)\\n\\n**Integration Object:**\\n```json\\n{\\n  \\\"id\\\": \\\"d4e5f6g7-4567-8901-defg-456789012def\\\",\\n  \\\"type\\\": \\\"integration\\\",\\n  \\\"user_id\\\": \\\"e5f6g7h8-5678-90ab-cdef-567890abcdef\\\",\\n  \\\"created_at\\\": \\\"2026-02-03T10:00:00.000Z\\\",\\n  \\\"updated_at\\\": \\\"2026-02-03T12:50:00.789Z\\\",\\n  \\\"deleted_at\\\": null,\\n  \\\"integration_type\\\": \\\"instagram\\\",\\n  \\\"integration_name\\\": \\\"@johnsmith\\\",\\n  \\\"status\\\": \\\"connected\\\",\\n  \\\"is_enabled\\\": true,\\n  \\\"access_token\\\": \\\"[REDACTED]\\\",\\n  \\\"refresh_token\\\": \\\"[REDACTED]\\\",\\n  \\\"token_expires_at\\\": \\\"2026-03-03T10:00:00.000Z\\\",\\n  \\\"last_sync_at\\\": \\\"2026-02-03T12:50:00.789Z\\\",\\n  \\\"last_sync_status\\\": \\\"success\\\",\\n  \\\"sync_cursor\\\": \\\"next_page_abc123\\\",\\n  \\\"items_synced\\\": 150,\\n  \\\"metadata\\\": {\\n    \\\"user_id\\\": \\\"instagram_user_12345\\\",\\n    \\\"username\\\": \\\"johnsmith\\\",\\n    \\\"profile_url\\\": \\\"https://instagram.com/johnsmith\\\",\\n    \\\"sync_settings\\\": {\\n      \\\"import_posts\\\": true,\\n      \\\"import_stories\\\": false,\\n      \\\"import_reels\\\": true\\n    }\\n  }\\n}\\n```\\n\\n**Media Created from Instagram:**\\n```json\\n{\\n  \\\"id\\\": \\\"f6g7h8i9-6789-0123-fghi-678901234fgh\\\",\\n  \\\"type\\\": \\\"media\\\",\\n  \\\"user_id\\\": \\\"e5f6g7h8-5678-90ab-cdef-567890abcdef\\\",\\n  \\\"source_type\\\": \\\"integration\\\",\\n  \\\"source_id\\\": \\\"instagram_media_abc123xyz\\\",\\n  \\\"filename\\\": \\\"instagram_post_2026_01_15.jpg\\\",\\n  \\\"media_type\\\": \\\"photo\\\",\\n  \\\"taken_at\\\": \\\"2026-01-15T18:30:00.000Z\\\",\\n  \\\"metadata\\\": {\\n    \\\"instagram\\\": {\\n      \\\"post_id\\\": \\\"abc123xyz\\\",\\n      \\\"permalink\\\": \\\"https://instagram.com/p/abc123xyz\\\",\\n      \\\"caption\\\": \\\"Amazing sunset! \\ud83c\\udf05 #sunset #beach\\\",\\n      \\\"likes\\\": 127,\\n      \\\"comments\\\": 8,\\n      \\\"hashtags\\\": [\\\"sunset\\\", \\\"beach\\\"]\\n    }\\n  }\\n}\\n```\\n\\n**Link (Media \\u2192 Integration):**\\n```json\\n{\\n  \\\"from_object_id\\\": \\\"f6g7h8i9-6789-0123-fghi-678901234fgh\\\",\\n  \\\"from_object_type\\\": \\\"media\\\",\\n  \\\"to_object_id\\\": \\\"d4e5f6g7-4567-8901-defg-456789012def\\\",\\n  \\\"to_object_type\\\": \\\"integration\\\",\\n  \\\"link_type\\\": \\\"source\\\",\\n  \\\"metadata\\\": {\\n    \\\"created_by\\\": \\\"system\\\",\\n    \\\"reason\\\": \\\"instagram_sync\\\",\\n    \\\"sync_timestamp\\\": \\\"2026-02-03T12:50:00.789Z\\\"\\n  }\\n}\\n```\\n\\n---\\n\\n## Open Questions\\n\\n1. **Object Versioning?**\\n   - Should we track version history for objects?\\n   - Store previous versions in separate table?\\n   - Defer to Phase 2?\\n\\n2. **Cascading Deletes?**\\n   - When user deletes media, delete links automatically?\\n   - When album deleted, delete links but keep media?\\n   - Database CASCADE vs. application logic?\\n\\n3. **Metadata Schema Validation?**\\n   - Should we enforce schema for common metadata patterns?\\n   - Use JSON Schema validation for known structures?\\n   - Or keep fully flexible?\\n\\n4. **Performance Optimization?**\\n   - Denormalize media_count in Album?\\n   - Materialize views for common queries?\\n   - When to add indexes?\\n\\n---\\n\\n## Next Steps\\n\\n- [ ] Review and approve object model\\n- [ ] Design database schema (see Database-Design/)\\n- [ ] Define API endpoints (see 03-API-Endpoints.md)\\n- [ ] Implement Pydantic models for validation\\n- [ ] Create SQLAlchemy ORM models\\n- [ ] Write database migrations\\n\\n---\\n\\n**Status:** Draft - Ready for review and feedback\\n**Next Document:** `02-Link-Model-Specification.md` (detailed link semantics)\\n\"\n    },\n    \"created_at\": \"2026-02-17T01:20:04.740236+00:00\",\n    \"updated_at\": \"2026-02-17T01:20:04.740236+00:00\",\n    \"deleted_at\": null,\n    \"source_type\": \"import\",\n    \"source_id\": \"file:01-Object-Model-Specification.md\"\n  }\n}"
  },
  "created_at": "2026-02-17T01:22:01.436959+00:00",
  "updated_at": "2026-02-17T01:22:01.436959+00:00",
  "deleted_at": null,
  "source_type": "import",
  "source_id": "file:v0001.json"
}