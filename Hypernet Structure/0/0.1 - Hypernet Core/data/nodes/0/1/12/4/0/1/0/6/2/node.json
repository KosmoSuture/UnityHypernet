{
  "address": "0.1.12.4.0.1.0.6.2",
  "type_address": null,
  "data": {
    "name": "2",
    "type": "folder",
    "path": "C:\\Hypernet\\Hypernet Structure\\0\\0.1 - Hypernet Core\\data-backup-pre-collision-fix\\nodes\\0\\1\\0\\6\\2",
    "content_preview": "{\n  \"address\": \"0.1.0.6.2\",\n  \"type_address\": null,\n  \"data\": {\n    \"name\": \"01-Partition-Management-And-Updates.md\",\n    \"type\": \"file\",\n    \"extension\": \".md\",\n    \"path\": \"C:\\\\Hypernet\\\\Hypernet Structure\\\\0\\\\0.1 - Hypernet Core\\\\0.1.0 - Planning & Documentation\\\\Architecture\\\\01-Partition-Management-And-Updates.md\",\n    \"size\": 16473,\n    \"content\": \"# Partition Management and Atomic Update System\\n\\n**Version:** 0.1.0\\n**Last Updated:** 2026-02-03\\n**Related:** 00-System-Architecture-Overview.md\\n\\n---\\n\\n## Overview\\n\\nThis document details the partition management strategy and atomic update mechanism for Hypernet Core's immutable infrastructure approach.\\n\\n---\\n\\n## A/B Partition Scheme\\n\\n### Concept\\n\\nHypernet uses **dual system partitions** (A and B) to enable atomic, zero-downtime updates with instant rollback capability.\\n\\n```\\nDisk Layout:\\n\\u250c\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2510\\n\\u2502 /dev/sda1  \\u2502 /boot (EFI)                    \\u2502 512 MB    \\u2502\\n\\u251c\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2524\\n\\u2502 /dev/sda2  \\u2502 / (System A)                   \\u2502 25 GB     \\u2502\\n\\u251c\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2524\\n\\u2502 /dev/sda3  \\u2502 /system-b (System B)           \\u2502 25 GB     \\u2502\\n\\u251c\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2524\\n\\u2502 /dev/sda4  \\u2502 /config                        \\u2502 2 GB      \\u2502\\n\\u251c\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2524\\n\\u2502 /dev/sda5  \\u2502 /data (Database)               \\u2502 200 GB    \\u2502\\n\\u251c\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2524\\n\\u2502 /dev/sda6  \\u2502 /media (User Uploads)          \\u2502 500 GB    \\u2502\\n\\u251c\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2524\\n\\u2502 /dev/sda7  \\u2502 /logs                          \\u2502 100 GB    \\u2502\\n\\u251c\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2524\\n\\u2502 /dev/sda8  \\u2502 /cache                         \\u2502 50 GB     \\u2502\\n\\u2514\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2518\\n```\\n\\n### Boot Process\\n\\n1. **Bootloader (GRUB)** reads boot configuration\\n2. Checks which partition is **active** (A or B)\\n3. Mounts active partition as `/` (read-only)\\n4. Mounts other partitions (`/config`, `/data`, `/media`, etc.)\\n5. Starts Hypernet services\\n\\n### Update Process\\n\\n```\\nCurrent State: System A is active (booted from /dev/sda2)\\n\\nUpdate Steps:\\n1. Download new system image (verified, signed)\\n2. Write to inactive partition (System B - /dev/sda3)\\n3. Verify written data (checksums, signatures)\\n4. Update bootloader to point to System B\\n5. Reboot\\n6. System B becomes active\\n7. If boot fails, bootloader auto-reverts to System A\\n\\nResult: System B is now active, System A available for rollback\\n```\\n\\n### Rollback\\n\\nIf a problem is detected after update:\\n```bash\\nhypernet-admin rollback\\n# Changes bootloader to previous partition\\n# Reboot required\\n```\\n\\nAutomatic rollback triggers:\\n- Failed boot (GRUB detects kernel panic or boot failure)\\n- Health check failures (Hypernet doesn't start within 5 minutes)\\n- Manual intervention (admin command)\\n\\n---\\n\\n## System Image Creation\\n\\n### Image Build Process\\n\\nSystem images are built in a **clean, reproducible environment** (container or VM).\\n\\n```yaml\\n# build-config.yaml\\nbase_os: ubuntu-24.04-server\\nhypernet_version: 0.1.0\\npython_version: 3.11\\npackages:\\n  - python3.11\\n  - python3-pip\\n  - postgresql-client\\n  - redis-tools\\n  - clamav\\n  - fail2ban\\nhypernet_dependencies:\\n  - fastapi==0.109.0\\n  - uvicorn==0.27.0\\n  - sqlalchemy==2.0.25\\n  - pydantic==2.5.0\\n  # ... (pinned versions from requirements.txt)\\n```\\n\\n**Build Steps:**\\n1. Start with minimal Ubuntu 24.04 base\\n2. Install system packages (apt)\\n3. Install Python and dependencies (pip)\\n4. Copy Hypernet application code\\n5. Pre-compile Python bytecode\\n6. Run tests and validation\\n7. Create filesystem image (squashfs or ext4)\\n8. Generate cryptographic signatures (GPG + SHA-256)\\n9. Publish image to update server\\n\\n### Image Signing\\n\\n```bash\\n# Generate image hash\\nsha256sum hypernet-0.1.0.img > hypernet-0.1.0.img.sha256\\n\\n# Sign with GPG\\ngpg --detach-sign --armor hypernet-0.1.0.img\\n\\n# Result:\\n# - hypernet-0.1.0.img (system image)\\n# - hypernet-0.1.0.img.sha256 (checksum)\\n# - hypernet-0.1.0.img.asc (GPG signature)\\n```\\n\\n### Image Verification\\n\\nBefore writing to disk:\\n```bash\\n# Verify GPG signature\\ngpg --verify hypernet-0.1.0.img.asc hypernet-0.1.0.img\\n\\n# Verify checksum\\nsha256sum -c hypernet-0.1.0.img.sha256\\n\\n# Only proceed if both pass\\n```\\n\\n---\\n\\n## Update Delivery Mechanism\\n\\n### Phase 1: Manual Updates\\n\\nAdmin downloads and applies updates manually:\\n```bash\\n# Download update package\\nwget https://updates.hypernet.io/releases/0.1.1/hypernet-0.1.1.img\\nwget https://updates.hypernet.io/releases/0.1.1/hypernet-0.1.1.img.sha256\\nwget https://updates.hypernet.io/releases/0.1.1/hypernet-0.1.1.img.asc\\n\\n# Verify and apply\\nhypernet-admin update --image hypernet-0.1.1.img\\n```\\n\\n### Phase 2: Automated Updates (Future)\\n\\n```yaml\\n# /config/updates.yaml\\nauto_update:\\n  enabled: true\\n  channel: stable  # stable, beta, or dev\\n  schedule: \\\"02:00\\\"  # Run at 2 AM daily\\n  require_approval: true  # Admin must approve before reboot\\n```\\n\\nUpdate daemon checks for new versions daily:\\n1. Query update server: `GET /api/updates?current=0.1.0&channel=stable`\\n2. If update available, download and verify\\n3. If `require_approval: false`, apply immediately\\n4. If `require_approval: true`, notify admin and wait\\n5. After approval, apply update and reboot\\n\\n---\\n\\n## Configuration Management\\n\\n### Configuration Separation\\n\\n**Problem:** Immutable system partition can't be modified, but config needs to be machine-specific.\\n\\n**Solution:** Separate `/config` partition that persists across updates.\\n\\n### Configuration Structure\\n\\n```\\n/config/\\n\\u251c\\u2500\\u2500 hypernet/\\n\\u2502   \\u251c\\u2500\\u2500 server.yaml          # Server settings (IP, port, hostname)\\n\\u2502   \\u251c\\u2500\\u2500 database.yaml        # Database connection\\n\\u2502   \\u251c\\u2500\\u2500 api.yaml             # API settings (rate limits, CORS)\\n\\u2502   \\u251c\\u2500\\u2500 integrations.yaml    # Enabled integrations\\n\\u2502   \\u2514\\u2500\\u2500 secrets/             # Encrypted secrets\\n\\u2502       \\u251c\\u2500\\u2500 jwt-secret.enc\\n\\u2502       \\u251c\\u2500\\u2500 db-password.enc\\n\\u2502       \\u2514\\u2500\\u2500 api-keys.enc\\n\\u251c\\u2500\\u2500 tls/\\n\\u2502   \\u251c\\u2500\\u2500 certificate.pem\\n\\u2502   \\u2514\\u2500\\u2500 private-key.pem\\n\\u2514\\u2500\\u2500 version                   # Config version for migration\\n```\\n\\n### Configuration Schema Versioning\\n\\nWhen updates change configuration format, a migration script runs on boot:\\n\\n```python\\n# /usr/bin/hypernet-config-migrate\\ndef migrate_config(current_version, target_version):\\n    if current_version < 2 and target_version >= 2:\\n        # Migration: v1 -> v2 (example)\\n        old_config = load_yaml('/config/hypernet/server.yaml')\\n        new_config = {\\n            'server': {\\n                'host': old_config.get('host', '0.0.0.0'),\\n                'port': old_config.get('port', 8443),\\n                'workers': old_config.get('wo\n... [truncated]",
    "content_file": "node.json"
  },
  "created_at": "2026-02-17T01:23:12.372272+00:00",
  "updated_at": "2026-02-17T01:23:12.372272+00:00",
  "deleted_at": null,
  "source_type": "import",
  "source_id": "folder:2"
}