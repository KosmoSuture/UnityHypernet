{
  "address": "0.1.12.4.0.1.0.12.2",
  "type_address": null,
  "data": {
    "name": "2",
    "type": "folder",
    "path": "C:\\Hypernet\\Hypernet Structure\\0\\0.1 - Hypernet Core\\data-backup-pre-collision-fix\\nodes\\0\\1\\0\\12\\2",
    "content_preview": "{\n  \"address\": \"0.1.0.12.2\",\n  \"type_address\": null,\n  \"data\": {\n    \"name\": \"02-Initial-Migration.sql\",\n    \"type\": \"file\",\n    \"extension\": \".sql\",\n    \"path\": \"C:\\\\Hypernet\\\\Hypernet Structure\\\\0\\\\0.1 - Hypernet Core\\\\0.1.0 - Planning & Documentation\\\\Database-Design\\\\02-Initial-Migration.sql\",\n    \"size\": 16261,\n    \"content\": \"-- Hypernet Core 0.1 - Initial Database Migration\\n-- PostgreSQL 15+\\n-- Run this script to create all tables and indexes\\n\\n-- Enable required extensions\\nCREATE EXTENSION IF NOT EXISTS \\\"uuid-ossp\\\";\\nCREATE EXTENSION IF NOT EXISTS \\\"pgcrypto\\\";\\n\\n-- ==============================================================================\\n-- TRIGGER FUNCTION: Auto-update updated_at timestamp\\n-- ==============================================================================\\n\\nCREATE OR REPLACE FUNCTION update_updated_at_column()\\nRETURNS TRIGGER AS $$\\nBEGIN\\n    NEW.updated_at = NOW();\\n    RETURN NEW;\\nEND;\\n$$ LANGUAGE plpgsql;\\n\\n-- ==============================================================================\\n-- TABLE: users\\n-- ==============================================================================\\n\\nCREATE TABLE users (\\n    -- Identity\\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\\n\\n    -- Authentication\\n    email VARCHAR(255) NOT NULL UNIQUE,\\n    password_hash VARCHAR(255) NOT NULL,\\n    email_verified BOOLEAN NOT NULL DEFAULT FALSE,\\n\\n    -- Profile\\n    display_name VARCHAR(100),\\n    avatar_url VARCHAR(1024),\\n\\n    -- Account Status\\n    is_active BOOLEAN NOT NULL DEFAULT TRUE,\\n    is_admin BOOLEAN NOT NULL DEFAULT FALSE,\\n\\n    -- Timestamps\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    last_login_at TIMESTAMP WITH TIME ZONE,\\n    deleted_at TIMESTAMP WITH TIME ZONE,\\n\\n    -- Storage Quotas\\n    storage_used BIGINT NOT NULL DEFAULT 0,\\n    storage_quota BIGINT NOT NULL DEFAULT 10737418240, -- 10 GB in bytes\\n\\n    -- Extensibility\\n    metadata JSONB NOT NULL DEFAULT '{}'::jsonb\\n);\\n\\n-- Indexes\\nCREATE INDEX idx_users_email ON users(email) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_users_created_at ON users(created_at);\\n\\n-- Trigger\\nCREATE TRIGGER users_updated_at BEFORE UPDATE ON users\\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\\n\\nCOMMENT ON TABLE users IS 'User accounts and authentication';\\nCOMMENT ON COLUMN users.storage_used IS 'Total bytes used by user media files';\\nCOMMENT ON COLUMN users.storage_quota IS 'Maximum bytes allowed (default 10GB)';\\n\\n-- ==============================================================================\\n-- TABLE: media\\n-- ==============================================================================\\n\\nCREATE TABLE media (\\n    -- Identity\\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\\n\\n    -- Ownership\\n    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,\\n\\n    -- Basic Info\\n    filename VARCHAR(255) NOT NULL,\\n    media_type VARCHAR(50) NOT NULL,\\n    mime_type VARCHAR(100) NOT NULL,\\n\\n    -- File Information\\n    size BIGINT NOT NULL,\\n    width INTEGER,\\n    height INTEGER,\\n    duration DOUBLE PRECISION,\\n\\n    -- Storage\\n    file_path VARCHAR(1024) NOT NULL,\\n    thumbnail_path VARCHAR(1024),\\n    hash VARCHAR(64) NOT NULL,\\n\\n    -- Dates and Location\\n    taken_at TIMESTAMP WITH TIME ZONE,\\n    latitude DOUBLE PRECISION,\\n    longitude DOUBLE PRECISION,\\n\\n    -- Source Tracking\\n    source_type VARCHAR(50),\\n    source_id VARCHAR(255),\\n\\n    -- Processing Status\\n    processing_status VARCHAR(50) NOT NULL DEFAULT 'pending',\\n    thumbnail_generated BOOLEAN NOT NULL DEFAULT FALSE,\\n    metadata_extracted BOOLEAN NOT NULL DEFAULT FALSE,\\n\\n    -- Timestamps\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    deleted_at TIMESTAMP WITH TIME ZONE,\\n\\n    -- Extensibility\\n    metadata JSONB NOT NULL DEFAULT '{}'::jsonb,\\n\\n    -- Constraints\\n    CONSTRAINT chk_media_type CHECK (media_type IN ('photo', 'video', 'document', 'other')),\\n    CONSTRAINT chk_processing_status CHECK (processing_status IN ('pending', 'processing', 'complete', 'failed')),\\n    CONSTRAINT chk_latitude CHECK (latitude IS NULL OR (latitude >= -90 AND latitude <= 90)),\\n    CONSTRAINT chk_longitude CHECK (longitude IS NULL OR (longitude >= -180 AND longitude <= 180)),\\n    CONSTRAINT chk_size CHECK (size > 0)\\n);\\n\\n-- Indexes\\nCREATE INDEX idx_media_user_id ON media(user_id) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_media_hash ON media(hash);\\nCREATE INDEX idx_media_taken_at ON media(taken_at) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_media_media_type ON media(media_type) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_media_source ON media(user_id, source_type, source_id) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_media_metadata ON media USING GIN(metadata);\\n\\n-- Trigger\\nCREATE TRIGGER media_updated_at BEFORE UPDATE ON media\\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\\n\\nCOMMENT ON TABLE media IS 'Photos, videos, and other media files';\\nCOMMENT ON COLUMN media.hash IS 'SHA-256 hash for deduplication';\\nCOMMENT ON COLUMN media.metadata IS 'EXIF data, tags, descriptions, integration-specific data';\\n\\n-- ==============================================================================\\n-- TABLE: albums\\n-- ==============================================================================\\n\\nCREATE TABLE albums (\\n    -- Identity\\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\\n\\n    -- Ownership\\n    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,\\n\\n    -- Basic Info\\n    name VARCHAR(200) NOT NULL,\\n    description TEXT,\\n\\n    -- Display\\n    cover_media_id UUID REFERENCES media(id) ON DELETE SET NULL,\\n    sort_order VARCHAR(50) NOT NULL DEFAULT 'date_desc',\\n\\n    -- Counts (denormalized)\\n    media_count INTEGER NOT NULL DEFAULT 0,\\n\\n    -- Privacy\\n    visibility VARCHAR(50) NOT NULL DEFAULT 'private',\\n\\n    -- Timestamps\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    deleted_at TIMESTAMP WITH TIME ZONE,\\n\\n    -- Source Tracking\\n    source_type VARCHAR(50),\\n    source_id VARCHAR(255),\\n\\n    -- Extensibility\\n    metadata JSONB NOT NULL DEFAULT '{}'::jsonb,\\n\\n    -- Constraints\\n    CONSTRAINT chk_sort_order CHECK (sort_order IN ('date_asc', 'date_desc', 'manual')),\\n    CONSTRAINT chk_visibility CHECK (visibility IN ('private', 'unlisted', 'public')),\\n    CONSTRAINT chk_media_count CHECK (media_count >= 0)\\n);\\n\\n-- Indexes\\nCREATE INDEX idx_albums_user_id ON albums(user_id) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_albums_name ON albums(user_id, name) WHERE deleted_at IS NULL;\\n\\n-- Trigger\\nCREATE TRIGGER albums_updated_at BEFORE UPDATE ON albums\\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\\n\\nCOMMENT ON TABLE albums IS 'Collections of media objects';\\nCOMMENT ON COLUMN albums.media_count IS 'Denormalized count of media in album (via links)';\\n\\n-- ==============================================================================\\n-- TABLE: integrations\\n-- ==============================================================================\\n\\nCREATE TABLE integrations (\\n    -- Identity\\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\\n\\n    -- Ownership\\n    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,\\n\\n    -- Integration Details\\n    integration_type VARCHAR(50) NOT NULL,\\n    integration_name VARCHAR(200) NOT NULL,\\n\\n    -- Status\\n    status VARCHAR(50) NOT NULL DEFAULT 'pending',\\n    is_enabled BOOLEAN NOT NULL DEFAULT TRUE,\\n\\n    -- OAuth2\\n    token_expires_at TIMESTAMP WITH TIME ZONE,\\n\\n    -- Sync State\\n    last_sync_at TIMESTAMP WITH TIME ZONE,\\n    last_sync_status VARCHAR(50),\\n    sync_cursor TEXT,\\n\\n    -- Statistics\\n    items_synced INTEGER NOT NULL DEFAULT 0,\\n\\n    -- Timestamps\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    deleted_at TIMESTAMP WITH TIME ZONE,\\n\\n    -- Source Tracking\\n    source_type VARCHAR(50),\\n    source_id VARCHAR(255),\\n\\n    -- Extensibility\\n    metadata JSONB NOT NULL DEFAULT '{}'::jsonb,\\n\\n    -- Constraints\\n    CONSTRAINT chk_integration_status CHECK (status IN ('connected', 'disconnected', 'error', 'pending')),\\n    CONSTRAINT chk_sync_status CHECK (last_sync_status IS NULL OR last_sync_status IN ('success', 'partial', 'failed')),\\n    CONSTRAINT chk_items_synced CHECK (items_synced >= 0)\\n);\\n\\n-- Indexes\\nCREATE INDEX idx_integrations_user_id ON integrations(user_id) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_integrations_type ON integrations(user_id, integration_type) WHERE deleted_at IS NULL;\\nCREATE INDEX idx_integrations_status ON integrations(status) WHERE deleted_at IS NULL;\\n\\n-- Trigger\\nCREATE TRIGGER integrations_updated_at BEFORE UPDATE ON integrations\\n    FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();\\n\\nCOMMENT ON TABLE integrations IS 'Connected external services (Instagram, Google Photos, etc.)';\\nCOMMENT ON COLUMN integrations.sync_cursor IS 'Pagination cursor for incremental sync';\\n\\n-- ==============================================================================\\n-- TABLE: integration_secrets\\n-- ==============================================================================\\n\\nCREATE TABLE integration_secrets (\\n    -- Identity (one-to-one with integrations)\\n    integration_id UUID PRIMARY KEY REFERENCES integrations(id) ON DELETE CASCADE,\\n\\n    -- OAuth2 Tokens (consider encrypting these)\\n    access_token TEXT,\\n    refresh_token TEXT,\\n\\n    -- Timestamps\\n    created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW(),\\n    updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT NOW()\\n);\\n\\n-- Trigger\\nCREATE TRIGGER integration_secrets_updated_at BEFORE UPDATE ON integration_s\n... [truncated]",
    "content_file": "node.json"
  },
  "created_at": "2026-02-17T01:23:11.718082+00:00",
  "updated_at": "2026-02-17T01:23:11.718082+00:00",
  "deleted_at": null,
  "source_type": "import",
  "source_id": "folder:2"
}